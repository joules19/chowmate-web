(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{80364:function(e,t,s){Promise.resolve().then(s.bind(s,48529))},48529:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return B}});var a=s(57437),r=s(2265),l=s(11713),n=s(29827),i=s(21770),c=s(88013);class d extends c.R{async getAllCustomers(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&""!==a&&t.append(s,a.toString())});let s=t.toString()?"?".concat(t):"";return this.get(s)}async getCustomerById(e){return this.get("/".concat(e))}async getCustomerOrders(e,t){let s=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,a]=e;null!=a&&""!==a&&s.append(t,a.toString())});let a="/".concat(e,"/orders").concat(s.toString()?"?".concat(s):"");return this.get(a)}async suspendCustomer(e,t){return this.put("/".concat(e,"/suspend"),t)}async activateCustomer(e,t){return this.put("/".concat(e,"/activate"),t||{})}async updateCustomerStatus(e,t){return this.put("/".concat(e,"/status"),t)}async deleteCustomer(e){return await this.deleteRequest("/".concat(e)),!0}async getCustomerStats(e,t){let s=new URLSearchParams;e&&s.append("dateFrom",e),t&&s.append("dateTo",t);let a="/stats".concat(s.toString()?"?".concat(s):"");return this.get(a)}async getCustomerActivities(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return this.get("/".concat(e,"/activities?limit=").concat(t))}async banCustomer(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this.updateCustomerStatus(e,{status:"Banned",reason:t,notifyCustomer:s})}async makeCustomerInactive(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this.updateCustomerStatus(e,{status:"Inactive",reason:t,notifyCustomer:s})}async bulkSuspend(e,t){return this.bulkAction("suspend",e,{reason:t})}async bulkActivate(e,t){return this.bulkAction("activate",e,{reason:t})}async bulkDelete(e,t){return this.bulkAction("delete",e,{reason:t})}constructor(){super("api/admin/customers")}}let o=new d,m={all:["customers"],lists:()=>[...m.all,"list"],list:e=>[...m.lists(),e],details:()=>[...m.all,"detail"],detail:e=>[...m.details(),e],orders:(e,t)=>[...m.detail(e),"orders",t],activities:(e,t)=>[...m.detail(e),"activities",t],stats:(e,t)=>[...m.all,"stats",e,t]};var x=s(41556),u=s(94565);let g=[{value:"",label:"All Statuses"},{value:"Active",label:"Active"},{value:"Suspended",label:"Suspended"},{value:"Inactive",label:"Inactive"},{value:"Banned",label:"Banned"}];function h(e){let{filters:t,onFiltersChange:s}=e,r=e=>{s({...t,search:e,pageNumber:1})},l=e=>{s({...t,status:e||void 0,pageNumber:1})},n=e=>{s({...t,dateFrom:e||void 0,pageNumber:1})},i=e=>{s({...t,dateTo:e||void 0,pageNumber:1})},c=e=>{s({...t,pageSize:parseInt(e),pageNumber:1})},d=Object.values(t).filter(Boolean).length-3;return(0,a.jsxs)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Customers"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by name, email, or phone...",value:t.search||"",onChange:e=>r(e.target.value),className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 placeholder-gray-500 transition-colors"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,a.jsx)("select",{value:t.status||"",onChange:e=>l(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors",children:g.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),(0,a.jsx)("input",{type:"date",value:t.dateFrom||"",onChange:e=>n(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),(0,a.jsx)("input",{type:"date",value:t.dateTo||"",onChange:e=>i(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors"})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[d," filter(s) applied"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Show:"}),(0,a.jsxs)("select",{value:t.pageSize||10,onChange:e=>c(e.target.value),className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors",children:[(0,a.jsx)("option",{value:10,children:"10"}),(0,a.jsx)("option",{value:25,children:"25"}),(0,a.jsx)("option",{value:50,children:"50"}),(0,a.jsx)("option",{value:100,children:"100"})]})]}),(0,a.jsx)("button",{onClick:()=>{s({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"})},className:"text-sm text-primary-600 hover:text-primary-700 font-medium transition-colors",children:"Clear Filters"})]})]})]})}var p=s(90173),y=s(81801),b=s(42548),j=s(60007),v=s(59035),N=s(61601),f=s(40196),w=s(85707),C=s(47842),k=s(77165);let S={suspend:{title:"Suspend",description:"This will prevent the customer from placing new orders",confirmText:"Suspend",buttonColor:"bg-yellow-600 hover:bg-yellow-700"},activate:{title:"Activate",description:"This will allow the customer to place orders again",confirmText:"Activate",buttonColor:"bg-green-600 hover:bg-green-700"},delete:{title:"Delete",description:"This will soft delete the customer. They can be restored later",confirmText:"Delete",buttonColor:"bg-red-600 hover:bg-red-700"},ban:{title:"Ban",description:"This will permanently ban the customer from the platform",confirmText:"Ban",buttonColor:"bg-red-600 hover:bg-red-700"}};function T(e){let{isOpen:t,onClose:s,onConfirm:l,action:n,itemName:i,itemType:c,requireReason:d=!0}=e,[o,m]=(0,r.useState)(""),[x,u]=(0,r.useState)(!1),g=S[n],h=async()=>{if(!d||o.trim()){u(!0);try{await l(o.trim()||void 0)}finally{u(!1),m("")}}},p=()=>{m(""),s()};return(0,a.jsx)(f.u,{appear:!0,show:t,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:p,children:[(0,a.jsx)(f.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(f.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(w.Vq.Panel,{className:"w-full max-w-md bg-background-secondary rounded-lg shadow-xl p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(C.Z,{className:"h-6 w-6 text-yellow-500"})}),(0,a.jsxs)(w.Vq.Title,{className:"text-lg font-semibold text-gray-900",children:[g.title," ",c]})]}),(0,a.jsx)("button",{onClick:p,className:"text-gray-400 hover:text-gray-500 p-1 rounded transition-colors",children:(0,a.jsx)(k.Z,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Are you sure you want to ",n," ",(0,a.jsx)("strong",{children:i}),"?"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:g.description})]}),d&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason ","activate"===n?"(optional)":"(required)"]}),(0,a.jsx)("textarea",{value:o,onChange:e=>m(e.target.value),placeholder:"Enter reason for ".concat(n,"ing this ").concat(c,"..."),rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 placeholder-gray-500 transition-colors"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:p,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-background-accent transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:h,disabled:x||d&&"activate"!==n&&!o.trim(),className:"px-4 py-2 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed ".concat(g.buttonColor),children:x?"Processing...":g.confirmText})]})]})})})})]})})}var A=s(89399),D=s(89453),F=s(56422),q=s(41077);function O(e){var t;let{customerId:s,isOpen:n,onClose:i}=e,{data:c,isLoading:d,error:x}=(0,l.a)({queryKey:m.detail(s),queryFn:()=>o.getCustomerById(s),staleTime:3e5,enabled:!!s,retry:2}),{data:u,isLoading:g}=(t={pageSize:5},(0,l.a)({queryKey:m.orders(s,t),queryFn:()=>o.getCustomerOrders(s,t),staleTime:3e5,enabled:!!s,retry:2}));return d?(0,a.jsx)(f.u,{appear:!0,show:n,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:i,children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(w.Vq.Panel,{className:"w-full max-w-4xl bg-background-secondary rounded-lg shadow-xl p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-6"}),(0,a.jsx)("div",{className:"space-y-4",children:[...Array(6)].map((e,t)=>(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-full"},t))})]})})})})]})}):x||!c?(0,a.jsx)(f.u,{appear:!0,show:n,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:i,children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(w.Vq.Panel,{className:"w-full max-w-md bg-background-secondary rounded-lg shadow-xl p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-red-600",children:"Failed to load customer details"}),(0,a.jsx)("button",{onClick:i,className:"mt-4 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})]})})})})]})}):(0,a.jsx)(f.u,{appear:!0,show:n,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:i,children:[(0,a.jsx)(f.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(f.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(w.Vq.Panel,{className:"w-full max-w-4xl bg-background-secondary rounded-lg shadow-xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-background-tertiary px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-full bg-primary-50 flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-lg font-medium text-primary-700",children:[c.firstName[0],c.lastName[0]]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.Vq.Title,{className:"text-lg font-semibold text-gray-900",children:c.fullName}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,a.jsx)("span",{className:(e=>{let t="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(e.toLowerCase()){case"active":return"".concat(t," bg-green-100 text-green-800");case"suspended":return"".concat(t," bg-yellow-100 text-yellow-800");case"inactive":default:return"".concat(t," bg-gray-100 text-gray-800");case"banned":return"".concat(t," bg-red-100 text-red-800")}})(c.status),children:c.status}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Customer since ",c.customerSince]})]})]})]}),(0,a.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg transition-colors",children:(0,a.jsx)(k.Z,{className:"h-6 w-6"})})]}),(0,a.jsx)("div",{className:"p-6 max-h-96 overflow-y-auto",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Contact Information"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(A.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:c.email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(D.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:c.phoneNumber})]}),c.address&&(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(F.Z,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,a.jsxs)("span",{className:"text-sm text-gray-900",children:[c.address,c.city&&", ".concat(c.city),c.state&&", ".concat(c.state),c.postalCode&&" ".concat(c.postalCode)]})]}),c.dateOfBirth&&(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(q.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:new Date(c.dateOfBirth).toLocaleDateString()})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-background-primary p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:c.totalOrders}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Total Orders"})]}),(0,a.jsxs)("div",{className:"bg-background-primary p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:["$",c.totalSpent.toLocaleString()]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Total Spent"})]})]})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Orders"}),g?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-12 bg-gray-200 rounded animate-pulse"},t))}):(null==u?void 0:u.data)&&u.data.length>0?(0,a.jsx)("div",{className:"space-y-2",children:u.data.slice(0,5).map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.vendorName}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.orderDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["$",e.totalAmount.toLocaleString()]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.status})]})]})},e.orderId))}):(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No orders found"})]})})]})}),(0,a.jsx)("div",{className:"bg-background-tertiary px-6 py-4 border-t border-gray-200 flex justify-end",children:(0,a.jsx)("button",{onClick:i,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})})]})})})})]})})}let L=e=>{let t="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(e.toLowerCase()){case"active":return"".concat(t," bg-green-100 text-green-800");case"suspended":return"".concat(t," bg-yellow-100 text-yellow-800");case"inactive":default:return"".concat(t," bg-gray-100 text-gray-800");case"banned":return"".concat(t," bg-red-100 text-red-800")}};function P(e){var t;let{filters:s,onFiltersChange:c}=e,[d,x]=(0,r.useState)(null),[u,g]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),[w,C]=(0,r.useState)(null),{data:k,isLoading:S,error:A,refetch:D}=(0,l.a)({queryKey:m.list(s),queryFn:()=>o.getAllCustomers(s),staleTime:12e4,refetchInterval:3e5,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)});console.log("\uD83D\uDD0D Customer Table Data:",{customersData:k,isLoading:S,error:A,customersArray:null==k?void 0:k.data,customersCount:null==k?void 0:null===(t=k.data)||void 0===t?void 0:t.length});let F=function(){let e=(0,n.NL)();return(0,i.D)({mutationFn:e=>{let{customerId:t,request:s}=e;return o.suspendCustomer(t,s)},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.invalidateQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),q=function(){let e=(0,n.NL)();return(0,i.D)({mutationFn:e=>{let{customerId:t,request:s}=e;return o.activateCustomer(t,s)},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.invalidateQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),P=function(){let e=(0,n.NL)();return(0,i.D)({mutationFn:e=>{let{customerId:t}=e;return o.deleteCustomer(t)},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.removeQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),I=e=>{let t=s.sortBy===e&&"asc"===s.sortOrder?"desc":"asc";c({...s,sortBy:e,sortOrder:t,pageNumber:1})},B=e=>{c({...s,pageNumber:e})},Z=e=>{x(e),g(!0)},z=(e,t)=>{C({type:e,customer:t}),f(!0)},K=async e=>{if(!w)return;let{type:t,customer:s}=w;try{switch(t){case"suspend":await F.mutateAsync({customerId:s.id,request:{reason:e||"Administrative action",notifyCustomer:!0}});break;case"activate":await q.mutateAsync({customerId:s.id,request:{reason:e,notifyCustomer:!0}});break;case"delete":await P.mutateAsync({customerId:s.id,request:{reason:e||"Administrative deletion",permanentDelete:!1}})}}catch(e){console.error("Failed to ".concat(t," customer:"),e)}finally{C(null),f(!1)}};if(S)return(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded mb-4 w-40"}),(0,a.jsx)("div",{className:"space-y-3",children:[...Array(10)].map((e,t)=>(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))})]})});if(A)return(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-red-600",children:["Failed to load customers: ",A.message]}),(0,a.jsx)("button",{onClick:()=>D(),className:"px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-700 rounded-md text-sm transition-colors",children:"Retry"})]})})});let R=(null==k?void 0:k.items)||[],V=k?{pageNumber:k.pageNumber,pageSize:k.pageSize,totalCount:k.totalCount}:null,M=e=>s.sortBy!==e?null:"asc"===s.sortOrder?(0,a.jsx)(p.Z,{className:"h-4 w-4"}):(0,a.jsx)(y.Z,{className:"h-4 w-4"});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-background-tertiary",children:(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Customers (",(null==V?void 0:V.totalCount)||0,")"]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-background-tertiary",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>I("firstName"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Customer"}),M("firstName")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>I("status"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Status"}),M("status")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>I("totalOrders"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Orders"}),M("totalOrders")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>I("totalSpent"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Total Spent"}),M("totalSpent")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>I("createdAt"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Joined"}),M("createdAt")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-background-secondary divide-y divide-gray-200",children:0===R.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center",children:(0,a.jsxs)("div",{className:"text-gray-500",children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"No customers found"}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Try adjusting your search filters"})]})})}):R.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-background-accent transition-colors cursor-pointer",onClick:()=>Z(e),children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"h-10 w-10 flex-shrink-0",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-50 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-medium text-primary-700",children:e.fullName.split(" ").map(e=>e[0]).join("").slice(0,2)})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.fullName}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:L(e.status),children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.totalOrders}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",e.totalSpent.toLocaleString()]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),Z(e)},className:"text-primary-600 hover:text-primary-700 p-1 rounded transition-colors",title:"View Details",children:(0,a.jsx)(b.Z,{className:"h-4 w-4"})}),"Active"===e.status?(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),z("suspend",e)},className:"text-yellow-600 hover:text-yellow-700 p-1 rounded transition-colors",title:"Suspend Customer",children:(0,a.jsx)(j.Z,{className:"h-4 w-4"})}):(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),z("activate",e)},className:"text-green-600 hover:text-green-700 p-1 rounded transition-colors",title:"Activate Customer",children:(0,a.jsx)(v.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),z("delete",e)},className:"text-red-600 hover:text-red-700 p-1 rounded transition-colors",title:"Delete Customer",children:(0,a.jsx)(N.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}),V&&V.totalPages>1&&(0,a.jsxs)("div",{className:"bg-background-tertiary px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,a.jsx)("button",{onClick:()=>B(V.page-1),disabled:V.page<=1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-background-secondary hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>B(V.page+1),disabled:V.page>=V.totalPages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-background-secondary hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]}),(0,a.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing"," ",(0,a.jsx)("span",{className:"font-medium",children:(V.page-1)*V.limit+1})," ","to"," ",(0,a.jsx)("span",{className:"font-medium",children:Math.min(V.page*V.limit,V.total)})," ","of"," ",(0,a.jsx)("span",{className:"font-medium",children:V.total})," ","results"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,a.jsx)("button",{onClick:()=>B(V.page-1),disabled:V.page<=1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-background-secondary text-sm font-medium text-gray-500 hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),Array.from({length:Math.min(5,V.totalPages)},(e,t)=>{let s=Math.max(1,V.page-2)+t;return s>V.totalPages?null:(0,a.jsx)("button",{onClick:()=>B(s),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium transition-colors ".concat(s===V.page?"z-10 bg-primary-500 border-primary-500 text-white":"bg-background-secondary border-gray-300 text-gray-500 hover:bg-background-accent"),children:s},s)}),(0,a.jsx)("button",{onClick:()=>B(V.page+1),disabled:V.page>=V.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-background-secondary text-sm font-medium text-gray-500 hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})})]})]})]}),d&&(0,a.jsx)(O,{customerId:d.id,isOpen:u,onClose:()=>{g(!1),x(null)}}),w&&(0,a.jsx)(T,{isOpen:h,onClose:()=>{f(!1),C(null)},onConfirm:K,action:w.type,itemName:w.customer.fullName,itemType:"customer",requireReason:"activate"!==w.type})]})}var I=s(76529);function B(){var e,t;let[s,n]=(0,r.useState)({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"}),{data:i,isLoading:c}=(0,l.a)({queryKey:m.stats(void 0,void 0),queryFn:()=>o.getCustomerStats(e,t),staleTime:6e5,refetchInterval:9e5,retry:2});return(0,a.jsxs)("div",{className:"space-y-6 p-6 bg-background-primary min-h-screen",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 tracking-tight",children:"Customer Management"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage customer accounts and monitor their activity"}),i&&!c&&(0,a.jsxs)("div",{className:"flex items-center space-x-6 mt-4",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:i.totalCustomers.toLocaleString()}),(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"Total"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-green-600",children:i.activeCustomers.toLocaleString()}),(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"Active"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-yellow-600",children:i.suspendedCustomers.toLocaleString()}),(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"Suspended"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-primary-600",children:i.newCustomersThisMonth.toLocaleString()}),(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"New this month"})]})]})]})}),i&&!c&&(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(0,I.x)(i.totalRevenue)})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-green-600 text-lg",children:"\uD83D\uDCB0"})})]})}),(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(0,I.x)(i.averageOrderValue)})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-primary-50 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-primary-600 text-lg",children:"\uD83D\uDCCA"})})]})}),(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[i.totalCustomers>0?Math.round(i.activeCustomers/i.totalCustomers*100):0,"%"]})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-blue-600 text-lg",children:"✅"})})]})}),(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Growth Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["+",i.totalCustomers>0?Math.round(i.newCustomersThisMonth/i.totalCustomers*100):0,"%"]})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-purple-600 text-lg",children:"\uD83D\uDCC8"})})]})})]}),(0,a.jsx)(h,{filters:s,onFiltersChange:n}),(0,a.jsx)(P,{filters:s,onFiltersChange:n})]})}}},function(e){e.O(0,[464,763,206,707,17,770,971,117,744],function(){return e(e.s=80364)}),_N_E=e.O()}]);