(()=>{var e={};e.id=674,e.ids=[674],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},85011:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>o}),s(57459),s(24609),s(14882),s(12523);var r=s(23191),a=s(88716),l=s(37922),n=s.n(l),i=s(95231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let o=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,57459)),"/Users/ayodelebabafemi/Projects/Chowmate-Web-App/src/app/admin/users/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,24609)),"/Users/ayodelebabafemi/Projects/Chowmate-Web-App/src/app/admin/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,14882)),"/Users/ayodelebabafemi/Projects/Chowmate-Web-App/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,12523)),"/Users/ayodelebabafemi/Projects/Chowmate-Web-App/src/app/not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/ayodelebabafemi/Projects/Chowmate-Web-App/src/app/admin/users/page.tsx"],m="/admin/users/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},26657:(e,t,s)=>{Promise.resolve().then(s.bind(s,34788))},34788:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>V});var r=s(10326),a=s(17577),l=s(20108),n=s(44976),i=s(10119),c=s(47785);class o extends c.R{constructor(){super("api/admin/customers")}async getAllCustomers(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,s.toString())});let s=t.toString()?`?${t}`:"";return this.get(s)}async getCustomerById(e){return this.get(`/${e}`)}async getCustomerOrders(e,t){let s=new URLSearchParams;t&&Object.entries(t).forEach(([e,t])=>{null!=t&&""!==t&&s.append(e,t.toString())});let r=`/${e}/orders${s.toString()?`?${s}`:""}`;return this.get(r)}async suspendCustomer(e,t){return this.put(`/${e}/suspend`,t)}async activateCustomer(e,t){return this.put(`/${e}/activate`,t||{})}async updateCustomerStatus(e,t){return this.put(`/${e}/status`,t)}async deleteCustomer(e){return await this.deleteRequest(`/${e}`),!0}async getCustomerStats(e,t){let s=new URLSearchParams;e&&s.append("dateFrom",e),t&&s.append("dateTo",t);let r=`/stats${s.toString()?`?${s}`:""}`;return this.get(r)}async getCustomerActivities(e,t=20){return this.get(`/${e}/activities?limit=${t}`)}async banCustomer(e,t,s=!0){return this.updateCustomerStatus(e,{status:"Banned",reason:t,notifyCustomer:s})}async makeCustomerInactive(e,t,s=!0){return this.updateCustomerStatus(e,{status:"Inactive",reason:t,notifyCustomer:s})}async bulkSuspend(e,t){return this.bulkAction("suspend",e,{reason:t})}async bulkActivate(e,t){return this.bulkAction("activate",e,{reason:t})}async bulkDelete(e,t){return this.bulkAction("delete",e,{reason:t})}}let d=new o,m={all:["customers"],lists:()=>[...m.all,"list"],list:e=>[...m.lists(),e],details:()=>[...m.all,"detail"],detail:e=>[...m.details(),e],orders:(e,t)=>[...m.detail(e),"orders",t],activities:(e,t)=>[...m.detail(e),"activities",t],stats:(e,t)=>[...m.all,"stats",e,t]};var u=s(81367),x=s(2560);let h=[{value:"",label:"All Statuses"},{value:"Active",label:"Active"},{value:"Suspended",label:"Suspended"},{value:"Inactive",label:"Inactive"},{value:"Banned",label:"Banned"}];function p({filters:e,onFiltersChange:t}){let s=s=>{t({...e,search:s,pageNumber:1})},a=s=>{t({...e,status:s||void 0,pageNumber:1})},l=s=>{t({...e,dateFrom:s||void 0,pageNumber:1})},n=s=>{t({...e,dateTo:s||void 0,pageNumber:1})},i=s=>{t({...e,pageSize:parseInt(s),pageNumber:1})},c=Object.values(e).filter(Boolean).length-3;return(0,r.jsxs)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Customers"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx(u.Z,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:e.search||"",onChange:e=>s(e.target.value),className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 placeholder-gray-500 transition-colors"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),r.jsx("select",{value:e.status||"",onChange:e=>a(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors",children:h.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),r.jsx("input",{type:"date",value:e.dateFrom||"",onChange:e=>l(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),r.jsx("input",{type:"date",value:e.dateTo||"",onChange:e=>n(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors"})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(x.Z,{className:"h-5 w-5 text-gray-400"}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[c," filter(s) applied"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm text-gray-600",children:"Show:"}),(0,r.jsxs)("select",{value:e.pageSize||10,onChange:e=>i(e.target.value),className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors",children:[r.jsx("option",{value:10,children:"10"}),r.jsx("option",{value:25,children:"25"}),r.jsx("option",{value:50,children:"50"}),r.jsx("option",{value:100,children:"100"})]})]}),r.jsx("button",{onClick:()=>{t({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"})},className:"text-sm text-primary-600 hover:text-primary-700 font-medium transition-colors",children:"Clear Filters"})]})]})]})}var g=s(54232),y=s(19018),b=s(96229),v=s(42502),j=s(27132),f=s(43404),N=s(49221),w=s(1762),k=s(19381),C=s(72591);let S={suspend:{title:"Suspend",description:"This will prevent the customer from placing new orders",confirmText:"Suspend",buttonColor:"bg-yellow-600 hover:bg-yellow-700"},activate:{title:"Activate",description:"This will allow the customer to place orders again",confirmText:"Activate",buttonColor:"bg-green-600 hover:bg-green-700"},delete:{title:"Delete",description:"This will soft delete the customer. They can be restored later",confirmText:"Delete",buttonColor:"bg-red-600 hover:bg-red-700"},ban:{title:"Ban",description:"This will permanently ban the customer from the platform",confirmText:"Ban",buttonColor:"bg-red-600 hover:bg-red-700"}};function A({isOpen:e,onClose:t,onConfirm:s,action:l,itemName:n,itemType:i,requireReason:c=!0}){let[o,d]=(0,a.useState)(""),[m,u]=(0,a.useState)(!1),x=S[l],h=async()=>{if(!c||o.trim()){u(!0);try{await s(o.trim()||void 0)}finally{u(!1),d("")}}},p=()=>{d(""),t()};return r.jsx(N.u,{appear:!0,show:e,as:a.Fragment,children:(0,r.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:p,children:[r.jsx(N.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),r.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsx(N.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,r.jsxs)(w.Vq.Panel,{className:"w-full max-w-md bg-background-secondary rounded-lg shadow-xl p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(k.Z,{className:"h-6 w-6 text-yellow-500"})}),(0,r.jsxs)(w.Vq.Title,{className:"text-lg font-semibold text-gray-900",children:[x.title," ",i]})]}),r.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-500 p-1 rounded transition-colors",children:r.jsx(C.Z,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Are you sure you want to ",l," ",r.jsx("strong",{children:n}),"?"]}),r.jsx("p",{className:"text-sm text-gray-500",children:x.description})]}),c&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason ","activate"===l?"(optional)":"(required)"]}),r.jsx("textarea",{value:o,onChange:e=>d(e.target.value),placeholder:`Enter reason for ${l}ing this ${i}...`,rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 placeholder-gray-500 transition-colors"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[r.jsx("button",{onClick:p,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-background-accent transition-colors",children:"Cancel"}),r.jsx("button",{onClick:h,disabled:m||c&&"activate"!==l&&!o.trim(),className:`px-4 py-2 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${x.buttonColor}`,children:m?"Processing...":x.confirmText})]})]})})})})]})})}var L=s(48258),R=s(56818),F=s(38518),q=s(37610);function E({customerId:e,isOpen:t,onClose:s}){var n;let{data:i,isLoading:c,error:o}=(0,l.a)({queryKey:m.detail(e),queryFn:()=>d.getCustomerById(e),staleTime:3e5,enabled:!!e,retry:2}),{data:u,isLoading:x}=(n={pageSize:5},(0,l.a)({queryKey:m.orders(e,n),queryFn:()=>d.getCustomerOrders(e,n),staleTime:3e5,enabled:!!e,retry:2}));return c?r.jsx(N.u,{appear:!0,show:t,as:a.Fragment,children:(0,r.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:s,children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"}),r.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsx(w.Vq.Panel,{className:"w-full max-w-4xl bg-background-secondary rounded-lg shadow-xl p-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-6"}),r.jsx("div",{className:"space-y-4",children:[...Array(6)].map((e,t)=>r.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"},t))})]})})})})]})}):o||!i?r.jsx(N.u,{appear:!0,show:t,as:a.Fragment,children:(0,r.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:s,children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"}),r.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsx(w.Vq.Panel,{className:"w-full max-w-md bg-background-secondary rounded-lg shadow-xl p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-red-600",children:"Failed to load customer details"}),r.jsx("button",{onClick:s,className:"mt-4 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})]})})})})]})}):r.jsx(N.u,{appear:!0,show:t,as:a.Fragment,children:(0,r.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:s,children:[r.jsx(N.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),r.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsx(N.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,r.jsxs)(w.Vq.Panel,{className:"w-full max-w-4xl bg-background-secondary rounded-lg shadow-xl overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-background-tertiary px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-primary-50 flex items-center justify-center",children:(0,r.jsxs)("span",{className:"text-lg font-medium text-primary-700",children:[i.firstName[0],i.lastName[0]]})}),(0,r.jsxs)("div",{children:[r.jsx(w.Vq.Title,{className:"text-lg font-semibold text-gray-900",children:i.fullName}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsx("span",{className:(e=>{let t="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(e.toLowerCase()){case"active":return`${t} bg-green-100 text-green-800`;case"suspended":return`${t} bg-yellow-100 text-yellow-800`;case"inactive":default:return`${t} bg-gray-100 text-gray-800`;case"banned":return`${t} bg-red-100 text-red-800`}})(i.status),children:i.status}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["Customer since ",i.customerSince]})]})]})]}),r.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg transition-colors",children:r.jsx(C.Z,{className:"h-6 w-6"})})]}),r.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Contact Information"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(L.Z,{className:"h-5 w-5 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-900",children:i.email})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(R.Z,{className:"h-5 w-5 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-900",children:i.phoneNumber})]}),i.address&&(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[r.jsx(F.Z,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("span",{className:"text-sm text-gray-900",children:[i.address,i.city&&`, ${i.city}`,i.state&&`, ${i.state}`,i.postalCode&&` ${i.postalCode}`]})]}),i.dateOfBirth&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(q.Z,{className:"h-5 w-5 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-900",children:new Date(i.dateOfBirth).toLocaleDateString()})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Statistics"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-background-primary p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.totalOrders||0}),r.jsx("div",{className:"text-sm text-gray-500",children:"Total Orders"})]}),(0,r.jsxs)("div",{className:"bg-background-primary p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:["₦",(i.totalSpent||0).toLocaleString()]}),r.jsx("div",{className:"text-sm text-gray-500",children:"Total Spent"})]})]})]})]}),r.jsx("div",{className:"space-y-6",children:(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Orders"}),x?r.jsx("div",{className:"space-y-2",children:[void 0,void 0,void 0].map((e,t)=>r.jsx("div",{className:"h-12 bg-gray-200 rounded animate-pulse"},t))}):u?.items&&u.items.length>0?r.jsx("div",{className:"space-y-2",children:u.items.slice(0,5).map(e=>r.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.vendorName}),r.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.orderDate).toLocaleDateString()})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["₦",e.totalAmount.toLocaleString()]}),r.jsx("div",{className:"text-xs text-gray-500",children:e.status})]})]})},e.orderId))}):r.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})]})})]})}),r.jsx("div",{className:"bg-background-tertiary px-6 py-4 border-t border-gray-200 flex justify-end",children:r.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})})]})})})})]})})}let T=e=>{let t="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(e.toLowerCase()){case"active":return`${t} bg-green-100 text-green-800`;case"suspended":return`${t} bg-yellow-100 text-yellow-800`;case"inactive":default:return`${t} bg-gray-100 text-gray-800`;case"banned":return`${t} bg-red-100 text-red-800`}};function Z({filters:e,onFiltersChange:t}){let[s,c]=(0,a.useState)(null),[o,u]=(0,a.useState)(!1),[x,h]=(0,a.useState)(!1),[p,N]=(0,a.useState)(null),{data:w,isLoading:k,error:C,refetch:S}=(0,l.a)({queryKey:m.list(e),queryFn:()=>d.getAllCustomers(e),staleTime:12e4,refetchInterval:3e5,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)});console.log("\uD83D\uDD0D Customer Table Data:",{customersData:w,isLoading:k,error:C,customersArray:w?.items,customersCount:w?.items?.length});let L=function(){let e=(0,n.NL)();return(0,i.D)({mutationFn:({customerId:e,request:t})=>d.suspendCustomer(e,t),onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.invalidateQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),R=function(){let e=(0,n.NL)();return(0,i.D)({mutationFn:({customerId:e,request:t})=>d.activateCustomer(e,t),onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.invalidateQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),F=function(){let e=(0,n.NL)();return(0,i.D)({mutationFn:({customerId:e})=>d.deleteCustomer(e),onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.removeQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),q=s=>{let r=e.sortBy===s&&"asc"===e.sortOrder?"desc":"asc";t({...e,sortBy:s,sortOrder:r,pageNumber:1})},Z=s=>{t({...e,pageNumber:s})},O=e=>{c(e),u(!0)},P=(e,t)=>{N({type:e,customer:t}),h(!0)},D=async e=>{if(!p)return;let{type:t,customer:s}=p;try{switch(t){case"suspend":await L.mutateAsync({customerId:s.id,request:{reason:e||"Administrative action",notifyCustomer:!0}});break;case"activate":await R.mutateAsync({customerId:s.id,request:{reason:e,notifyCustomer:!0}});break;case"delete":await F.mutateAsync({customerId:s.id,request:{reason:e||"Administrative deletion",permanentDelete:!1}})}}catch(e){console.error(`Failed to ${t} customer:`,e)}finally{N(null),h(!1)}};if(k)return r.jsx("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-6 bg-gray-200 rounded mb-4 w-40"}),r.jsx("div",{className:"space-y-3",children:[...Array(10)].map((e,t)=>r.jsx("div",{className:"h-16 bg-gray-200 rounded"},t))})]})});if(C)return r.jsx("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"text-red-600",children:["Failed to load customers: ",C.message]}),r.jsx("button",{onClick:()=>S(),className:"px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-700 rounded-md text-sm transition-colors",children:"Retry"})]})})});let $=w?.items||[],B=w?{pageNumber:w.pageNumber,pageSize:w.pageSize,totalCount:w.totalCount,totalPages:Math.ceil(w.totalCount/w.pageSize),page:w.pageNumber,limit:w.pageSize,total:w.totalCount}:null,M=t=>e.sortBy!==t?null:"asc"===e.sortOrder?r.jsx(g.Z,{className:"h-4 w-4"}):r.jsx(y.Z,{className:"h-4 w-4"});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-background-tertiary",children:(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Customers (",B?.totalCount||0,")"]})}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-background-tertiary",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>q("firstName"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Customer"}),M("firstName")]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>q("status"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Status"}),M("status")]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>q("totalOrders"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Orders"}),M("totalOrders")]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>q("totalSpent"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Total Spent"}),M("totalSpent")]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>q("createdAt"),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"Joined"}),M("createdAt")]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-background-secondary divide-y divide-gray-200",children:0===$.length?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:(0,r.jsxs)("div",{className:"text-gray-500",children:[r.jsx("p",{className:"text-lg font-medium",children:"No customers found"}),r.jsx("p",{className:"text-sm mt-1",children:"Try adjusting your search filters"})]})})}):$.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-background-accent transition-colors cursor-pointer",onClick:()=>O(e),children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary-50 flex items-center justify-center",children:r.jsx("span",{className:"text-sm font-medium text-primary-700",children:e.fullName.split(" ").map(e=>e[0]).join("").slice(0,2)})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.fullName}),r.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:T(e.status),children:e.status})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.totalOrders}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["₦",e.totalSpent.toLocaleString()]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:t=>{t.stopPropagation(),O(e)},className:"text-primary-600 hover:text-primary-700 p-1 rounded transition-colors",title:"View Details",children:r.jsx(b.Z,{className:"h-4 w-4"})}),"Active"===e.status?r.jsx("button",{onClick:t=>{t.stopPropagation(),P("suspend",e)},className:"text-yellow-600 hover:text-yellow-700 p-1 rounded transition-colors",title:"Suspend Customer",children:r.jsx(v.Z,{className:"h-4 w-4"})}):r.jsx("button",{onClick:t=>{t.stopPropagation(),P("activate",e)},className:"text-green-600 hover:text-green-700 p-1 rounded transition-colors",title:"Activate Customer",children:r.jsx(j.Z,{className:"h-4 w-4"})}),r.jsx("button",{onClick:t=>{t.stopPropagation(),P("delete",e)},className:"text-red-600 hover:text-red-700 p-1 rounded transition-colors",title:"Delete Customer",children:r.jsx(f.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}),B&&B.totalPages>1&&(0,r.jsxs)("div",{className:"bg-background-tertiary px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[r.jsx("button",{onClick:()=>Z(B.page-1),disabled:B.page<=1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-background-secondary hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),r.jsx("button",{onClick:()=>Z(B.page+1),disabled:B.page>=B.totalPages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-background-secondary hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]}),(0,r.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[r.jsx("div",{children:(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing"," ",r.jsx("span",{className:"font-medium",children:(B.page-1)*B.limit+1})," ","to"," ",r.jsx("span",{className:"font-medium",children:Math.min(B.page*B.limit,B.total)})," ","of"," ",r.jsx("span",{className:"font-medium",children:B.total})," ","results"]})}),r.jsx("div",{children:(0,r.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[r.jsx("button",{onClick:()=>Z(B.page-1),disabled:B.page<=1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-background-secondary text-sm font-medium text-gray-500 hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),Array.from({length:Math.min(5,B.totalPages)},(e,t)=>{let s=Math.max(1,B.page-2)+t;return s>B.totalPages?null:r.jsx("button",{onClick:()=>Z(s),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium transition-colors ${s===B.page?"z-10 bg-primary-500 border-primary-500 text-white":"bg-background-secondary border-gray-300 text-gray-500 hover:bg-background-accent"}`,children:s},s)}),r.jsx("button",{onClick:()=>Z(B.page+1),disabled:B.page>=B.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-background-secondary text-sm font-medium text-gray-500 hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})})]})]})]}),s&&r.jsx(E,{customerId:s.id,isOpen:o,onClose:()=>{u(!1),c(null)}}),p&&r.jsx(A,{isOpen:x,onClose:()=>{h(!1),N(null)},onConfirm:D,action:p.type,itemName:p.customer.fullName,itemType:"customer",requireReason:"activate"!==p.type})]})}var O=s(83670),P=s(60882),D=s(47468);function $({isOpen:e,onClose:t,onUserSelect:s}){let[l,n]=(0,a.useState)(""),[i,c]=(0,a.useState)([]),[o,d]=(0,a.useState)(!1),[m,x]=(0,a.useState)(""),h=e=>{s(e),t(),n(""),c([])},p=e=>{switch(e){case"Customer":return"bg-blue-100 text-blue-700";case"Vendor":return"bg-green-100 text-green-700";case"Rider":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-700"}};return e?r.jsx(N.u,{appear:!0,show:e,as:a.Fragment,children:(0,r.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:t,children:[r.jsx(N.x,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),r.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsx(N.x,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,r.jsxs)(w.EM,{className:"w-full max-w-2xl transform overflow-hidden rounded-card bg-surface-0 shadow-xl transition-all",children:[r.jsx("div",{className:"px-6 py-4 border-b border-border-light",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-text-primary flex items-center",children:[r.jsx(u.Z,{className:"h-5 w-5 mr-2"}),"Search Users"]}),r.jsx("button",{onClick:t,className:"p-2 hover:bg-surface-100 rounded-full transition-colors",children:r.jsx(C.Z,{className:"h-5 w-5 text-text-primary"})})]})}),(0,r.jsxs)("div",{className:"px-6 py-4",children:[(0,r.jsxs)("div",{className:"relative mb-4",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(u.Z,{className:"h-5 w-5 text-text-tertiary"})}),r.jsx("input",{type:"text",value:l,onChange:e=>n(e.target.value),placeholder:"Search by name, email, or phone number...",className:"w-full pl-10 pr-4 py-3 border border-border-light rounded-button bg-surface-0 text-text-primary focus:ring-2 focus:ring-primary-500 focus:border-transparent",autoFocus:!0})]}),(0,r.jsxs)("div",{className:"max-h-96 overflow-y-auto",children:[o&&(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"}),r.jsx("span",{className:"ml-2 text-text-secondary",children:"Searching..."})]}),m&&r.jsx("div",{className:"p-4 bg-danger-50 border border-danger-200 rounded-card",children:r.jsx("p",{className:"text-sm text-danger-800",children:m})}),!o&&!m&&l&&l.length>=2&&0===i.length&&(0,r.jsxs)("div",{className:"text-center py-8 text-text-tertiary",children:[r.jsx(P.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,r.jsxs)("p",{children:['No users found matching "',l,'"']}),r.jsx("p",{className:"text-sm mt-1",children:"Try searching by name, email, or phone number"})]}),!o&&!m&&i.length>0&&r.jsx("div",{className:"space-y-2",children:i.map(e=>r.jsx("button",{onClick:()=>h(e),className:"w-full p-4 bg-surface-50 hover:bg-surface-100 rounded-card text-left transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:r.jsx(P.Z,{className:"h-5 w-5 text-primary-600"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium text-text-primary",children:e.name}),r.jsx("p",{className:"text-sm text-text-secondary",children:e.email}),r.jsx("p",{className:"text-sm text-text-tertiary",children:e.phone})]})]})}),(0,r.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[r.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${p(e.currentRole)}`,children:e.currentRole}),r.jsx("span",{className:"text-xs text-text-tertiary",children:e.status}),(e.hasActiveOrders||e.hasActiveDeliveries)&&(0,r.jsxs)("span",{className:"text-xs text-warning-600 font-medium",children:["Has active ",e.hasActiveOrders?"orders":"deliveries"]})]})]})},e.userId))}),(!l||l.length<2)&&(0,r.jsxs)("div",{className:"text-center py-8 text-text-tertiary",children:[r.jsx(u.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),r.jsx("p",{children:"Type at least 2 characters to search for users..."}),r.jsx("p",{className:"text-sm mt-1",children:"Search by name, email, or phone number"})]})]})]}),r.jsx("div",{className:"px-6 py-4 border-t border-border-light bg-surface-50",children:r.jsx("p",{className:"text-sm text-text-tertiary",children:"Select a user to switch their role. Users with active orders or deliveries cannot have their roles changed."})})]})})})})]})}):null}function B({user:e,isOpen:t,onClose:s,onSuccess:l}){let[n,i]=(0,a.useState)("Customer"),[c,o]=(0,a.useState)(""),[d,m]=(0,a.useState)(!0),[u,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)(""),g=["Customer","Vendor","Rider"].filter(t=>t!==e.currentRole),y=async t=>{t.preventDefault(),x(!0),p("");try{let t={fromRole:e.currentRole,toRole:n,reason:c,notifyUser:d},r=await D.W.switchUserRole(e.userId,t);l(r),s()}catch(e){p(e instanceof Error?e.message:"An error occurred")}finally{x(!1)}},b=()=>window.confirm(`Are you sure you want to switch ${e.name}'s role from ${e.currentRole} to ${n}?

This will:
• Remove all ${e.currentRole}-specific data
• Create a new ${n} profile
• Send them through ${n} onboarding if needed
• Log this action for audit purposes

This action cannot be easily undone.`);return t?r.jsx(N.u,{appear:!0,show:t,as:a.Fragment,children:(0,r.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:s,children:[r.jsx(N.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),r.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsx(N.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,r.jsxs)(w.Vq.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-card bg-surface-0 shadow-xl transition-all",children:[r.jsx("div",{className:"px-6 py-4 border-b border-border-light",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-text-primary flex items-center",children:[r.jsx(P.Z,{className:"h-5 w-5 mr-2"}),"Switch User Role"]}),r.jsx("button",{onClick:s,className:"p-2 hover:bg-surface-100 rounded-full transition-colors",children:r.jsx(C.Z,{className:"h-5 w-5 text-text-primary"})})]})}),(0,r.jsxs)("div",{className:"px-6 py-4",children:[(0,r.jsxs)("div",{className:"mb-6 p-4 bg-surface-50 rounded-card",children:[r.jsx("h3",{className:"font-medium text-text-primary mb-2",children:"User Information"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("p",{children:[r.jsx("span",{className:"font-medium",children:"Name:"})," ",e.name]}),(0,r.jsxs)("p",{children:[r.jsx("span",{className:"font-medium",children:"Email:"})," ",e.email]}),(0,r.jsxs)("p",{children:[r.jsx("span",{className:"font-medium",children:"Phone:"})," ",e.phone]}),(0,r.jsxs)("p",{children:[r.jsx("span",{className:"font-medium",children:"Current Role:"}),r.jsx("span",{className:"ml-1 px-2 py-1 bg-primary-100 text-primary-700 rounded text-xs",children:e.currentRole})]})]})]}),(e.hasActiveOrders||e.hasActiveDeliveries)&&r.jsx("div",{className:"mb-4 p-3 bg-warning-50 border border-warning-200 rounded-card",children:(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx(k.Z,{className:"h-5 w-5 text-warning-600 mr-2 mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{className:"text-sm text-warning-800",children:[r.jsx("p",{className:"font-medium",children:"Warning"}),(0,r.jsxs)("p",{children:["This user has active ",e.hasActiveOrders?"orders":"deliveries",". Role switching will fail until these are completed."]})]})]})}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b()&&y(e)},className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"toRole",className:"block text-sm font-medium text-text-secondary mb-2",children:"Switch to Role:"}),r.jsx("select",{id:"toRole",value:n,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-border-light rounded-button bg-surface-0 text-text-primary focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:g.map(e=>r.jsx("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-text-secondary mb-2",children:"Reason (optional):"}),r.jsx("textarea",{id:"reason",value:c,onChange:e=>o(e.target.value),placeholder:"Explain why this role change is needed...",maxLength:500,rows:3,className:"w-full px-3 py-2 border border-border-light rounded-button bg-surface-0 text-text-primary focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none"}),(0,r.jsxs)("p",{className:"text-xs text-text-tertiary mt-1",children:[c.length,"/500 characters"]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"notifyUser",checked:d,onChange:e=>m(e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-border-light rounded"}),r.jsx("label",{htmlFor:"notifyUser",className:"ml-2 text-sm text-text-primary",children:"Notify user via email"})]}),h&&r.jsx("div",{className:"p-3 bg-danger-50 border border-danger-200 rounded-card",children:r.jsx("p",{className:"text-sm text-danger-800",children:h})}),(0,r.jsxs)("div",{className:"flex space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:s,disabled:u,className:"flex-1 px-4 py-2 text-text-primary bg-surface-100 hover:bg-surface-200 rounded-button transition-colors disabled:opacity-50",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:u||e.hasActiveOrders||e.hasActiveDeliveries,className:"flex-1 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-button transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Switching...":`Switch to ${n}`})]})]})]})]})})})})]})}):null}function M({onSuccess:e,onError:t}){let[s,l]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!1),[c,o]=(0,a.useState)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>l(!0),className:"inline-flex items-center px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-button transition-colors",children:[r.jsx(O.Z,{className:"h-5 w-5 mr-2"}),"Switch User Role"]}),r.jsx($,{isOpen:s,onClose:()=>l(!1),onUserSelect:e=>{o(e),i(!0)}}),c&&r.jsx(B,{user:c,isOpen:n,onClose:()=>{i(!1),o(null)},onSuccess:t=>{o(null),e&&e(t)}})]})}var U=s(83158),I=s(57869),z=s(67830);function V(){var e,t;let[s,n]=(0,a.useState)({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"}),{data:i,isLoading:c}=(0,l.a)({queryKey:m.stats(void 0,void 0),queryFn:()=>d.getCustomerStats(e,t),staleTime:6e5,refetchInterval:9e5,retry:2}),[o,u]=(0,a.useState)(null);return r.jsx(U.Z,{permission:I.y3.VIEW_USERS,children:(0,r.jsxs)("div",{className:"space-y-6 p-6 bg-background-primary min-h-screen",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 tracking-tight",children:"Customer Management"}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage customer accounts and monitor their activity"}),i&&!c&&(0,r.jsxs)("div",{className:"flex items-center space-x-6 mt-4",children:[(0,r.jsxs)("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:i.totalCustomers.toLocaleString()}),r.jsx("span",{className:"text-gray-500 ml-1",children:"Total"})]}),(0,r.jsxs)("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium text-green-600",children:i.activeCustomers.toLocaleString()}),r.jsx("span",{className:"text-gray-500 ml-1",children:"Active"})]}),(0,r.jsxs)("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium text-yellow-600",children:i.suspendedCustomers.toLocaleString()}),r.jsx("span",{className:"text-gray-500 ml-1",children:"Suspended"})]}),(0,r.jsxs)("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium text-primary-600",children:i.newCustomersThisMonth.toLocaleString()}),r.jsx("span",{className:"text-gray-500 ml-1",children:"New this month"})]})]})]}),r.jsx(M,{onSuccess:e=>{u(e)},onError:e=>{console.error("Role switch failed:",e)}})]}),o&&r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"ml-3 flex-1",children:[r.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Role Switch Successful"}),(0,r.jsxs)("div",{className:"mt-1 text-sm text-green-700",children:[(0,r.jsxs)("p",{children:["User ",o.userId," switched from ",o.fromRole," to ",o.toRole]}),(0,r.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Switched at ",new Date(o.switchedAt).toLocaleString()]})]})]}),r.jsx("div",{className:"ml-3 flex-shrink-0",children:r.jsx("button",{onClick:()=>u(null),className:"inline-flex text-green-400 hover:text-green-500 focus:outline-none",children:r.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})}),i&&!c&&(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsx("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(0,z.x)(i.totalRevenue)})]}),r.jsx("div",{className:"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-green-600 text-lg",children:"\uD83D\uDCB0"})})]})}),r.jsx("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(0,z.x)(i.averageOrderValue)})]}),r.jsx("div",{className:"h-12 w-12 bg-primary-50 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-primary-600 text-lg",children:"\uD83D\uDCCA"})})]})}),r.jsx("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Rate"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[i.totalCustomers>0?Math.round(i.activeCustomers/i.totalCustomers*100):0,"%"]})]}),r.jsx("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 text-lg",children:"✅"})})]})}),r.jsx("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Growth Rate"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["+",i.totalCustomers>0?Math.round(i.newCustomersThisMonth/i.totalCustomers*100):0,"%"]})]}),r.jsx("div",{className:"h-12 w-12 bg-purple-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-purple-600 text-lg",children:"\uD83D\uDCC8"})})]})})]}),r.jsx(p,{filters:s,onFiltersChange:n}),r.jsx(Z,{filters:s,onFiltersChange:n})]})})}},83158:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s(10326),a=s(17577),l=s(35047);function n({children:e,permission:t,fallback:s=null,redirectTo:n="/unauthorized"}){let[i,c]=(0,a.useState)(null),o=(0,l.useRouter)();return null===i?r.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):i?r.jsx(r.Fragment,{children:e}):s?r.jsx(r.Fragment,{children:s}):r.jsx("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-4",children:"Access Denied"}),r.jsx("p",{className:"text-text-secondary mb-6",children:"You don't have permission to access this page."}),r.jsx("button",{onClick:()=>o.back(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Go Back"})]})})}s(16786)},47468:(e,t,s)=>{"use strict";s.d(t,{W:()=>l});var r=s(47785);class a extends r.R{constructor(){super("/api/admin/users")}async suspendUser(e){return this.post(`/${e}/suspend`)}async activateUser(e){return this.post(`/${e}/activate`)}async updateUserRole(e,t){return this.put(`/${e}/role`,{roleId:t})}async getUserByEmail(e){try{return await this.get(`/email/${encodeURIComponent(e)}`)}catch{return null}}async bulkSuspendUsers(e){return this.bulkAction("suspend",e)}async bulkActivateUsers(e){return this.bulkAction("activate",e)}async getAllUsers(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))});let s=t.toString(),r=s?`?${s}`:"";return this.get(r)}async searchUsers(e){return(await this.getAllUsers({search:e,pageSize:20,sortBy:"firstName",sortOrder:"asc"})).items.map(e=>({userId:e.id,name:e.fullName,email:e.email,phone:e.phoneNumber,currentRole:e.role,status:e.status,hasActiveOrders:e.hasActiveOrders,hasActiveDeliveries:e.hasActiveDeliveries,walletId:e.walletId,walletBalance:e.walletBalance}))}async switchUserRole(e,t){return this.put(`/${e}/switch-role`,t)}}let l=new a},67830:(e,t,s)=>{"use strict";s.d(t,{x:()=>r});let r=e=>`₦${e.toLocaleString("en-NG",{minimumFractionDigits:2,maximumFractionDigits:2})}`},57459:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`/Users/ayodelebabafemi/Projects/Chowmate-Web-App/src/app/admin/users/page.tsx#default`)},83670:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"}))})},37610:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))})},19018:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))})},54232:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))})},48258:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))})},19381:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))})},2560:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))})},38518:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))})},42502:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))})},56818:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))})},27132:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))})},43404:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},60882:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(17577);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))})}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,449,463,253,762,169,152],()=>s(85011));module.exports=r})();