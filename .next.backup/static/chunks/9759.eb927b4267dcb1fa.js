"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9759],{59759:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var a=s(57437),r=s(2265),l=s(40196),n=s(85707),i=s(41463),c=s(77165),d=s(338),o=s(1442),m=s(47842),u=s(30166),x=s(38187);let p=(0,u.default)(()=>s.e(314).then(s.bind(s,314)).then(e=>({default:e.PaystackButton})),{loadableGenerated:{webpack:()=>[314]},ssr:!1});function h(e){var t,s;let{isOpen:u,onClose:h,user:b,onSuccess:f}=e,[y,g]=(0,r.useState)(""),[j,v]=(0,r.useState)(!1),[N,w]=(0,r.useState)(""),[k,F]=(0,r.useState)("idle"),[C,P]=(0,r.useState)(""),[E,S]=(0,r.useState)(null),[Z,L]=(0,r.useState)(!1);(0,r.useEffect)(()=>{L(!0)},[]);let I=e=>{switch(e){case 0:return"Pending";case 1:return"Completed";case 2:return"Failed";case 3:return"Reversed";default:return"Unknown"}},M=async e=>{console.log("Payment Success Callback:",e),F("processing");try{let t=await x.Z.verifyWalletFundingForWeb(e.reference,b.userId);console.log("Verification Result:",t),t.isSuccess&&200===t.statusCode?1===t.data.status?(S(t.data),F("success"),setTimeout(()=>{f(),W()},3e3)):(F("failed"),w("Transaction status: ".concat(I(t.data.status),". Please contact support if this persists."))):(F("failed"),w(t.message||"Payment verification failed. Please contact support."))}catch(e){console.error("Verification Error:",e),F("failed"),w(e instanceof Error?e.message:"Payment verification failed")}},T=async()=>{if(!y||0>=parseFloat(y)){w("Please enter a valid amount");return}if(100>parseFloat(y)){w("Minimum funding amount is ₦100");return}v(!0),w("");try{let e=await x.Z.fundWallet({userId:b.userId,amount:parseFloat(y),email:b.email});console.log("Initialize Result:",e),e.status?P(e.data.reference):w(e.message||"Failed to initialize payment"),v(!1)}catch(e){console.error("Initialize Error:",e),w(e instanceof Error?e.message:"Failed to initialize payment"),v(!1)}},W=()=>{g(""),w(""),F("idle"),P(""),S(null)},z=()=>{"processing"!==k&&(W(),h())},_=e=>{let t=e.replace(/[^0-9.]/g,""),s=t.split(".");return s.length>2?s[0]+"."+s.slice(1).join(""):t};return u?(0,a.jsx)(l.u,{appear:!0,show:u,as:r.Fragment,children:(0,a.jsxs)(n.Vq,{as:"div",className:"relative z-50",onClose:z,children:[(0,a.jsx)(l.x,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(l.x,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(n.EM,{className:"w-full max-w-md transform overflow-hidden rounded-card bg-surface-0 shadow-xl transition-all",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-border-light",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-text-primary flex items-center",children:[(0,a.jsx)(i.Z,{className:"h-5 w-5 mr-2"}),"Fund Wallet"]}),(0,a.jsx)("button",{onClick:z,disabled:"processing"===k,className:"p-2 hover:bg-surface-100 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,a.jsx)(c.Z,{className:"h-5 w-5 text-text-primary"})})]})}),(0,a.jsxs)("div",{className:"px-6 py-4",children:[(0,a.jsx)("div",{className:"bg-surface-50 rounded-card p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-full bg-primary-100 flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"h-6 w-6 text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-text-primary",children:b.name}),(0,a.jsx)("p",{className:"text-sm text-text-secondary",children:b.email}),(0,a.jsx)("p",{className:"text-sm text-text-tertiary",children:b.phone})]})]})}),"success"===k&&E&&(0,a.jsx)("div",{className:"bg-success-50 border border-success-200 rounded-card p-4 mb-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(o.Z,{className:"h-5 w-5 text-success-600 mr-2 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-success-800 font-medium mb-2",children:"Wallet funded successfully!"}),(0,a.jsxs)("div",{className:"text-xs text-success-700 space-y-1",children:[(0,a.jsxs)("p",{children:["Amount funded: ₦",null===(t=E.amountFunded)||void 0===t?void 0:t.toLocaleString()]}),(0,a.jsxs)("p",{children:["New wallet balance: ₦",null===(s=E.walletBalance)||void 0===s?void 0:s.toLocaleString()]}),(0,a.jsxs)("p",{children:["Status: ",I(E.status)]}),(0,a.jsxs)("p",{children:["Transaction ID: ",E.transactionId]}),(0,a.jsxs)("p",{children:["Date: ",new Date(E.transactionDate).toLocaleString()]})]})]})]})}),"processing"===k&&(0,a.jsx)("div",{className:"bg-primary-50 border border-primary-200 rounded-card p-4 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-primary-600 mr-2"}),(0,a.jsx)("p",{className:"text-sm text-primary-800",children:"Verifying payment... Please wait."})]})}),"failed"===k&&N&&(0,a.jsx)("div",{className:"bg-danger-50 border border-danger-200 rounded-card p-4 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5 text-danger-600 mr-2"}),(0,a.jsx)("p",{className:"text-sm text-danger-800",children:N})]})}),"idle"===k&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Amount to Fund (₦)"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary",children:"₦"}),(0,a.jsx)("input",{type:"text",value:y,onChange:e=>{g(_(e.target.value)),w("")},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 border border-border-light rounded-button bg-surface-0 text-text-primary focus:ring-2 focus:ring-primary-500 focus:border-transparent",disabled:j})]}),(0,a.jsx)("p",{className:"text-xs text-text-tertiary mt-1",children:"Minimum amount: ₦100"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-text-primary mb-2",children:"Quick amounts:"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["500","1000","2000","5000","10000","20000"].map(e=>(0,a.jsxs)("button",{onClick:()=>g(e),className:"py-2 px-3 text-sm border border-border-light rounded-button hover:bg-surface-100 transition-colors",disabled:j,children:["₦",e]},e))})]}),N&&(0,a.jsx)("div",{className:"bg-danger-50 border border-danger-200 rounded-card p-4 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5 text-danger-600 mr-2"}),(0,a.jsx)("p",{className:"text-sm text-danger-800",children:N})]})}),(0,a.jsx)("div",{className:"bg-primary-50 border border-primary-200 rounded-card p-4 mb-6",children:(0,a.jsxs)("p",{className:"text-sm text-primary-800",children:[(0,a.jsx)("strong",{children:"Note:"})," You will be redirected to the payment portal to complete the payment securely. The funds will be credited to the user's wallet immediately after successful payment."]})})]})]}),"idle"===k&&(0,a.jsx)("div",{className:"px-6 py-4 border-t border-border-light bg-surface-50",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:z,disabled:j,className:"flex-1 py-3 px-4 border border-border-light rounded-button text-text-primary hover:bg-surface-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),C?Z?(0,a.jsx)(p,{reference:C,email:b.email,amount:Math.round(100*parseFloat(y)),publicKey:"pk_live_ba9bd7fd1c1e9cf86e738007ba2d7875cecd16cd",text:"Pay with Paystack",onSuccess:M,onClose:()=>{console.log("Payment Closed"),"processing"!==k&&(F("failed"),w("Payment was cancelled or failed"))},className:"flex-1 py-3 px-4 bg-green-600 hover:bg-green-700 text-white rounded-button transition-colors flex items-center justify-center"}):(0,a.jsx)("button",{disabled:!0,className:"flex-1 py-3 px-4 bg-gray-400 text-white rounded-button transition-colors flex items-center justify-center cursor-not-allowed",children:"Loading Payment..."}):(0,a.jsx)("button",{onClick:T,disabled:j||!y||0>=parseFloat(y),className:"flex-1 py-3 px-4 bg-primary-600 hover:bg-primary-700 text-white rounded-button transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),"Initialize Payment"]})})]})})]})})})})]})}):null}},1442:function(e,t,s){var a=s(2265);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=r},47842:function(e,t,s){var a=s(2265);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))});t.Z=r}}]);