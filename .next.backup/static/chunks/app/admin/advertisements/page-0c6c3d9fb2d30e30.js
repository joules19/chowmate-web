(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2539],{78928:function(e,t,r){Promise.resolve().then(r.bind(r,81483))},81483:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return P}});var s=r(57437),a=r(2265),n=r(19967),i=r(42548),l=r(12594),d=r(55026),c=r(60007),o=r(59035),u=r(61601),m=r(11713),x=r(29827),p=r(21770),h=r(88013);class v extends h.R{async getAdvertisements(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[r,s]=e;null!=s&&t.append(r,s.toString())});let r=t.toString()?"?".concat(t):"",s=await this.get(r),a=Array.isArray(s)?s:[];return{items:a,totalCount:a.length,pageNumber:(null==e?void 0:e.pageNumber)||1,pageSize:(null==e?void 0:e.pageSize)||10}}async createAdvertisement(e){return this.create(e)}async createAdvertisementWithFormData(e){return this.post("",e)}async updateAdvertisement(e,t){return this.update(e,t)}async updateAdvertisementWithFormData(e,t){return this.put("/".concat(e),t)}async toggleStatus(e){return this.put("/".concat(e,"/toggle-status"))}async deleteAdvertisement(e){return this.delete(e)}constructor(){super("/api/admin/advertisements")}}let g=new v,y={all:["advertisements"],lists:()=>[...y.all,"list"],list:e=>[...y.lists(),e],details:()=>[...y.all,"detail"],detail:e=>[...y.details(),e]};function b(e){return(0,m.a)({queryKey:y.list(e),queryFn:()=>g.getAdvertisements(e),staleTime:12e4,refetchInterval:3e5,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)})}var f=r(20465),j=r(41021);function N(e){let{filters:t,onFiltersChange:r,onCreateClick:m,onEditClick:h,onDetailsClick:v}=e,[N,w]=(0,a.useState)([]),{data:C,isLoading:k,error:A,refetch:S}=b(t),q=function(){let e=(0,x.NL)();return(0,p.D)({mutationFn:e=>g.toggleStatus(e),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:y.lists()}),e.invalidateQueries({queryKey:y.detail(r)})}})}(),F=function(){let e=(0,x.NL)();return(0,p.D)({mutationFn:e=>g.deleteAdvertisement(e),onSuccess:()=>{e.invalidateQueries({queryKey:y.lists()})}})}(),D=(null==C?void 0:C.items)||[],Z=C?{pageNumber:C.pageNumber,pageSize:C.pageSize,totalCount:C.totalCount}:void 0,I=async e=>{try{await q.mutateAsync(e.id),j.ZP.success("Advertisement ".concat(e.isActive?"deactivated":"activated"," successfully"))}catch(e){j.ZP.error("Failed to toggle advertisement status")}},P=async e=>{if(window.confirm("Are you sure you want to delete this advertisement?"))try{await F.mutateAsync(e.id),j.ZP.success("Advertisement deleted successfully")}catch(e){j.ZP.error("Failed to delete advertisement")}},T=e=>(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({customer:"bg-blue-100 text-blue-800",vendor:"bg-green-100 text-green-800",rider:"bg-purple-100 text-purple-800"}[e]||"bg-gray-100 text-gray-800"),children:e}),V=e=>(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e?"Active":"Inactive"}),K=e=>(0,s.jsx)("div",{className:"w-6 h-6 rounded border border-gray-300 ".concat({default:"bg-gray-200",blue:"bg-blue-200",green:"bg-green-200",orange:"bg-orange-200",purple:"bg-purple-200",pink:"bg-pink-200",0:"bg-gray-200",1:"bg-blue-200",2:"bg-green-200",3:"bg-orange-200",4:"bg-purple-200",5:"bg-pink-200"}[e]||"bg-gray-200")});return A?(0,s.jsx)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light p-6",children:(0,s.jsxs)("div",{className:"text-center text-danger-600",children:[(0,s.jsxs)("p",{children:["Error loading advertisements: ",A.message]}),(0,s.jsx)("button",{onClick:()=>S(),className:"mt-2 btn-secondary",children:"Try Again"})]})}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-text-primary",children:"Advertisements"}),(0,s.jsx)("p",{className:"text-sm text-text-secondary mt-1",children:"Manage advertisement campaigns"})]}),(0,s.jsx)("button",{onClick:m,className:"btn-primary",children:"Create Advertisement"})]}),(0,s.jsx)(f.Z,{data:D,columns:[{key:"imageUrl",label:"Image",render:e=>(0,s.jsx)("div",{className:"flex items-center",children:e.imageUrl?(0,s.jsx)("img",{src:e.imageUrl,alt:e.title,className:"w-12 h-12 rounded-lg object-cover"}):(0,s.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center",children:(0,s.jsx)(n.Z,{className:"w-6 h-6 text-gray-400"})})})},{key:"title",label:"Title",sortable:!0,render:e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium text-text-primary",children:e.title}),(0,s.jsx)("div",{className:"text-sm text-text-tertiary truncate max-w-xs",children:e.description})]})},{key:"vendorName",label:"Vendor",render:e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-text-primary",children:e.vendorName||"N/A"}),(0,s.jsx)("div",{className:"text-xs text-text-tertiary",children:e.businessType||""})]})},{key:"userType",label:"Target",render:e=>T(e.userType)},{key:"backgroundColor",label:"Color",render:e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[K(e.backgroundColor),(0,s.jsx)("span",{className:"text-sm text-text-secondary capitalize",children:"number"==typeof e.backgroundColor?["default","blue","green","orange","purple","pink"][e.backgroundColor]||"default":e.backgroundColor})]})},{key:"isActive",label:"Status",render:e=>V(e.isActive)},{key:"createdAt",label:"Created",sortable:!0,render:e=>new Date(e.createdAt).toLocaleDateString()},{key:"actions",label:"Actions",render:e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),v(e)},className:"p-1 text-primary-600 hover:text-primary-900",title:"View Details",children:(0,s.jsx)(i.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),h(e)},className:"p-1 text-warning-600 hover:text-warning-900",title:"Edit",children:(0,s.jsx)(l.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),I(e)},className:"p-1 ".concat(e.isActive?"text-gray-600 hover:text-gray-900":"text-green-600 hover:text-green-900"),title:e.isActive?"Deactivate":"Activate",disabled:q.isPending,children:q.isPending?(0,s.jsx)(d.Z,{className:"w-4 h-4 animate-spin"}):e.isActive?(0,s.jsx)(c.Z,{className:"w-4 h-4"}):(0,s.jsx)(o.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),P(e)},className:"p-1 text-danger-600 hover:text-danger-900",title:"Delete",disabled:F.isPending,children:F.isPending?(0,s.jsx)(d.Z,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(u.Z,{className:"w-4 h-4"})})]})}],loading:k,pagination:Z,onSort:(e,s)=>{r({...t,sortBy:e,sortOrder:s})},onPageChange:e=>{r({...t,pageNumber:e})},onRowClick:v})]})}var w=r(41556),C=r(94565);function k(e){let{filters:t,onFiltersChange:r}=e,[n,i]=(0,a.useState)(!1),l=e=>{r({...t,search:e,pageNumber:1})},d=e=>{r({...t,userType:""===e?void 0:e,pageNumber:1})},c=e=>{r({...t,isActive:""===e?void 0:"true"===e,pageNumber:1})},o=e=>{r({...t,vendorId:e||void 0,pageNumber:1})},u=()=>{let e=["pageNumber","pageSize","sortBy","sortOrder"];return Object.entries(t).filter(t=>{let[r,s]=t;return!e.includes(r)&&void 0!==s&&""!==s}).length};return(0,s.jsxs)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(w.Z,{className:"h-5 w-5 text-text-tertiary"})}),(0,s.jsx)("input",{type:"text",placeholder:"Search advertisements...",value:t.search||"",onChange:e=>l(e.target.value),className:"input-field pl-10"})]}),(0,s.jsxs)("select",{value:t.userType||"",onChange:e=>d(e.target.value),className:"input-field",children:[(0,s.jsx)("option",{value:"",children:"All Target Users"}),(0,s.jsx)("option",{value:"customer",children:"Customer"}),(0,s.jsx)("option",{value:"vendor",children:"Vendor"}),(0,s.jsx)("option",{value:"rider",children:"Rider"})]}),(0,s.jsxs)("select",{value:void 0===t.isActive?"":t.isActive.toString(),onChange:e=>c(e.target.value),className:"input-field",children:[(0,s.jsx)("option",{value:"",children:"All Status"}),(0,s.jsx)("option",{value:"true",children:"Active"}),(0,s.jsx)("option",{value:"false",children:"Inactive"})]}),(0,s.jsx)("div",{className:"flex space-x-2",children:(0,s.jsxs)("button",{onClick:()=>i(!n),className:"btn-secondary flex items-center space-x-2 flex-1",children:[(0,s.jsx)(C.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Advanced"}),u()>0&&(0,s.jsx)("span",{className:"bg-primary-500 text-white text-xs rounded-full px-2 py-0.5 ml-auto",children:u()})]})})]}),n&&(0,s.jsxs)("div",{className:"border-t border-border-light pt-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Vendor ID"}),(0,s.jsx)("input",{type:"text",placeholder:"Enter vendor ID",value:t.vendorId||"",onChange:e=>o(e.target.value),className:"input-field"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Sort By"}),(0,s.jsxs)("select",{value:t.sortBy||"createdAt",onChange:e=>r({...t,sortBy:e.target.value,pageNumber:1}),className:"input-field",children:[(0,s.jsx)("option",{value:"createdAt",children:"Created Date"}),(0,s.jsx)("option",{value:"title",children:"Title"}),(0,s.jsx)("option",{value:"userType",children:"Target User"}),(0,s.jsx)("option",{value:"isActive",children:"Status"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Sort Order"}),(0,s.jsxs)("select",{value:t.sortOrder||"desc",onChange:e=>r({...t,sortOrder:e.target.value,pageNumber:1}),className:"input-field",children:[(0,s.jsx)("option",{value:"desc",children:"Newest First"}),(0,s.jsx)("option",{value:"asc",children:"Oldest First"})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end mt-4",children:(0,s.jsx)("button",{onClick:()=>{r({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"})},className:"btn-secondary",children:"Clear All Filters"})})]})]})}var A=r(40196),S=r(85707),q=r(77165),F=r(98438);function D(e){var t;let{isOpen:r,onClose:i,advertisement:l}=e,[c,o]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[h,v]=(0,a.useState)(null),[b,f]=(0,a.useState)(""),[N,w]=(0,a.useState)(""),[C,k]=(0,a.useState)("customer"),[D,Z]=(0,a.useState)("default"),[I,P]=(0,a.useState)(!1),T=function(){let e=(0,x.NL)();return(0,p.D)({mutationFn:e=>g.createAdvertisementWithFormData(e),onSuccess:()=>{e.invalidateQueries({queryKey:y.lists()})}})}(),V=function(){let e=(0,x.NL)();return(0,p.D)({mutationFn:e=>{let{advertisementId:t,request:r,formData:s}=e;if(s)return g.updateAdvertisementWithFormData(t,s);if(r)return g.updateAdvertisement(t,r);throw Error("Either request or formData must be provided")},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:y.lists()}),e.invalidateQueries({queryKey:y.detail(r.advertisementId)})}})}(),{data:K,isLoading:Q}=(0,F.Rd)({pageSize:1e3}),L=!!l;(0,a.useEffect)(()=>{r&&(l?(o(l.title),m(l.description),f(l.imageUrl),w(l.vendorId),k(l.userType),Z("string"==typeof l.backgroundColor?l.backgroundColor:"default"),v(null)):(o(""),m(""),f(""),v(null),w(""),k("customer"),Z("default")))},[r,l]);let z=async e=>{if(e.preventDefault(),!c.trim()){j.ZP.error("Title is required");return}if(!u.trim()){j.ZP.error("Description is required");return}if(!L&&!h){j.ZP.error("Image is required");return}if(!N.trim()){j.ZP.error("Vendor ID is required");return}P(!0);try{if(L&&l){if(h){let e=new FormData;e.append("title",c.trim()),e.append("description",u.trim()),e.append("image",h),e.append("vendorId",N.trim()),e.append("userType","customer"===C?"1":"vendor"===C?"2":"3"),e.append("advertismentBackgroundColor",{default:"1",blue:"2",green:"3",orange:"4",purple:"5",pink:"6"}[D]||"1"),console.log("Update FormData being sent:"),e.forEach((e,t)=>{console.log("".concat(t,":"),e)}),await V.mutateAsync({advertisementId:l.id,formData:e})}else{let e=new FormData;e.append("title",c.trim()),e.append("description",u.trim()),e.append("vendorId",N.trim()),e.append("userType","customer"===C?"1":"vendor"===C?"2":"3"),e.append("advertismentBackgroundColor",{default:"1",blue:"2",green:"3",orange:"4",purple:"5",pink:"6"}[D]||"1"),console.log("Update FormData (no image) being sent:"),e.forEach((e,t)=>{console.log("".concat(t,":"),e)}),await V.mutateAsync({advertisementId:l.id,formData:e})}j.ZP.success("Advertisement updated successfully")}else{if(!h){j.ZP.error("Image is required for new advertisements");return}let e=new FormData;e.append("Title",c.trim()),e.append("Description",u.trim()),e.append("Image",h),e.append("vendorId",N.trim()),e.append("userType","customer"===C?"1":"vendor"===C?"2":"3"),e.append("advertismentBackgroundColor",{default:"1",blue:"2",green:"3",orange:"4",purple:"5",pink:"6"}[D]||"1"),console.log("FormData being sent:"),e.forEach((e,t)=>{console.log("".concat(t,":"),e)}),await T.mutateAsync(e),j.ZP.success("Advertisement created successfully")}i()}catch(e){j.ZP.error(L?"Failed to update advertisement":"Failed to create advertisement")}finally{P(!1)}};return(0,s.jsx)(A.u,{appear:!0,show:r,as:a.Fragment,children:(0,s.jsxs)(S.Vq,{as:"div",className:"relative z-50",onClose:i,children:[(0,s.jsx)(A.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,s.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,s.jsx)(A.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,s.jsxs)(S.Vq.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded-card bg-surface-0 p-6 text-left align-middle shadow-xl transition-all",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)(S.Vq.Title,{as:"h3",className:"text-lg font-semibold text-text-primary",children:L?"Edit Advertisement":"Create Advertisement"}),(0,s.jsx)("button",{onClick:i,className:"text-text-tertiary hover:text-text-primary transition-colors",children:(0,s.jsx)(q.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-text-secondary mb-1",children:"Title *"}),(0,s.jsx)("input",{id:"title",type:"text",value:c,onChange:e=>o(e.target.value),placeholder:"Enter advertisement title",className:"input-field",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-text-secondary mb-1",children:"Description *"}),(0,s.jsx)("textarea",{id:"description",value:u,onChange:e=>m(e.target.value),placeholder:"Enter advertisement description",rows:3,className:"input-field",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"image",className:"block text-sm font-medium text-text-secondary mb-1",children:["Advertisement Image ",!L&&"*"]}),(0,s.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-border-light border-dashed rounded-lg hover:border-primary-300 transition-colors",children:(0,s.jsxs)("div",{className:"space-y-1 text-center",children:[b?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:b,alt:"Preview",className:"mx-auto h-32 w-32 object-cover rounded-lg"}),(0,s.jsx)("button",{type:"button",onClick:()=>{f(""),v(null);let e=document.getElementById("image");e&&(e.value="")},className:"absolute -top-2 -right-2 bg-danger-500 text-white rounded-full p-1 hover:bg-danger-600",children:(0,s.jsx)(q.Z,{className:"w-4 h-4"})})]}):(0,s.jsx)(n.Z,{className:"mx-auto h-12 w-12 text-text-tertiary"}),(0,s.jsx)("div",{className:"flex text-sm text-text-secondary",children:(0,s.jsxs)("label",{htmlFor:"image",className:"relative cursor-pointer bg-surface-0 rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-primary-500",children:[(0,s.jsx)("span",{children:b?"Change image":"Upload an image"}),(0,s.jsx)("input",{id:"image",name:"image",type:"file",accept:"image/*",className:"sr-only",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){v(r);let e=new FileReader;e.onload=e=>{var t;f(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(r)}}})]})}),(0,s.jsx)("p",{className:"text-xs text-text-tertiary",children:"PNG, JPG, GIF up to 10MB"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"vendorId",className:"block text-sm font-medium text-text-secondary mb-1",children:"Vendor *"}),Q?(0,s.jsxs)("div",{className:"input-field flex items-center justify-center py-3",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 animate-spin mr-2"}),"Loading vendors..."]}):(0,s.jsxs)("select",{id:"vendorId",value:N,onChange:e=>w(e.target.value),className:"input-field",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select a vendor"}),null==K?void 0:null===(t=K.items)||void 0===t?void 0:t.map(e=>(0,s.jsx)("option",{value:e.id,children:e.businessName},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"userType",className:"block text-sm font-medium text-text-secondary mb-1",children:"Target User Type *"}),(0,s.jsxs)("select",{id:"userType",value:C,onChange:e=>k(e.target.value),className:"input-field",required:!0,children:[(0,s.jsx)("option",{value:"customer",children:"Customer"}),(0,s.jsx)("option",{value:"vendor",children:"Vendor"}),(0,s.jsx)("option",{value:"rider",children:"Rider"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Background Color"}),(0,s.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:[{value:"default",label:"Default",colorClass:"bg-gray-200"},{value:"blue",label:"Blue",colorClass:"bg-blue-200"},{value:"green",label:"Green",colorClass:"bg-green-200"},{value:"orange",label:"Orange",colorClass:"bg-orange-200"},{value:"purple",label:"Purple",colorClass:"bg-purple-200"},{value:"pink",label:"Pink",colorClass:"bg-pink-200"}].map(e=>(0,s.jsxs)("label",{className:"relative flex flex-col items-center p-3 border-2 rounded-lg cursor-pointer transition-colors ".concat(D===e.value?"border-primary-500 bg-primary-50":"border-border-light hover:border-primary-300"),children:[(0,s.jsx)("input",{type:"radio",name:"backgroundColor",value:e.value,checked:D===e.value,onChange:e=>Z(e.target.value),className:"sr-only"}),(0,s.jsx)("div",{className:"w-8 h-8 rounded border border-gray-300 ".concat(e.colorClass)}),(0,s.jsx)("span",{className:"text-xs text-text-secondary mt-1",children:e.label})]},e.value))})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-border-light",children:[(0,s.jsx)("button",{type:"button",onClick:i,className:"btn-secondary",disabled:I,children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",className:"btn-primary",disabled:I,children:[I&&(0,s.jsx)(d.Z,{className:"w-4 h-4 animate-spin mr-2"}),I?L?"Updating...":"Creating...":L?"Update Advertisement":"Create Advertisement"]})]})]})]})})})})]})})}var Z=r(76737),I=r(8226);function P(){let[e,t]=(0,a.useState)({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"}),[r,n]=(0,a.useState)(!1),[i,l]=(0,a.useState)(),{data:d}=b(e),c=(()=>{let e=(null==d?void 0:d.items)||[],t=(null==d?void 0:d.totalCount)||0,r=e.filter(e=>e.isActive).length,s=e.filter(e=>!e.isActive).length,a=e.reduce((e,t)=>(e[t.userType]=(e[t.userType]||0)+1,e),{});return{total:t,active:r,inactive:s,customer:a.customer||0,vendor:a.vendor||0,rider:a.rider||0}})();return(0,s.jsx)(Z.Z,{permission:I.y3.VIEW_ADVERTISEMENTS,children:(0,s.jsxs)("div",{className:"space-y-6 p-6 bg-surface-primary min-h-screen",children:[(0,s.jsx)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-text-primary tracking-tight",children:"Advertisement Management"}),(0,s.jsx)("p",{className:"text-sm text-text-secondary mt-1",children:"Create and manage advertisement campaigns across different user types"}),(0,s.jsxs)("div",{className:"flex items-center space-x-6 mt-4",children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-text-primary",children:c.total.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Total"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-success-600",children:c.active.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Active"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:c.inactive.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Inactive"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-blue-600",children:c.customer.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Customer"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-green-600",children:c.vendor.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Vendor"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-purple-600",children:c.rider.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Rider"})]})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsx)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-text-secondary",children:"Total Campaigns"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-text-primary",children:c.total})]}),(0,s.jsx)("div",{className:"h-12 w-12 bg-primary-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-lg",children:"\uD83D\uDCE2"})})]})}),(0,s.jsx)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-text-secondary",children:"Active Campaigns"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-text-primary",children:c.active})]}),(0,s.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-lg",children:"âœ…"})})]})}),(0,s.jsx)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-text-secondary",children:"Customer Ads"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-text-primary",children:c.customer})]}),(0,s.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-lg",children:"\uD83D\uDC65"})})]})}),(0,s.jsx)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-text-secondary",children:"Vendor Ads"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-text-primary",children:c.vendor})]}),(0,s.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-lg",children:"\uD83C\uDFEA"})})]})})]}),(0,s.jsx)(k,{filters:e,onFiltersChange:t}),(0,s.jsx)(N,{filters:e,onFiltersChange:t,onCreateClick:()=>{l(void 0),n(!0)},onEditClick:e=>{l(e),n(!0)},onDetailsClick:e=>{console.log("View details for:",e.id)}}),(0,s.jsx)(D,{isOpen:r,onClose:()=>{n(!1),l(void 0)},advertisement:i})]})})}},76737:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var s=r(57437),a=r(2265),n=r(99376),i=r(19157);function l(e){let{children:t,permission:r,fallback:l=null,redirectTo:d="/unauthorized"}=e,[c,o]=(0,a.useState)(null),u=(0,n.useRouter)();return((0,a.useEffect)(()=>{(()=>{let e=i.$.hasPermission(r);o(e),!e&&d&&u.push(d)})()},[r,d,u]),null===c)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):c?(0,s.jsx)(s.Fragment,{children:t}):l?(0,s.jsx)(s.Fragment,{children:l}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-text-primary mb-4",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-text-secondary mb-6",children:"You don't have permission to access this page."}),(0,s.jsx)("button",{onClick:()=>u.back(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Go Back"})]})})}},20465:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var s=r(57437),a=r(2265),n=r(90173),i=r(81801),l=r(52700),d=r(73910);function c(e){let{data:t,columns:r,loading:c=!1,pagination:o,onSort:u,onPageChange:m,onRowClick:x}=e,[p,h]=(0,a.useState)(null),v=e=>{let t="asc";p&&p.key===e&&"asc"===p.direction&&(t="desc"),h({key:e,direction:t}),null==u||u(e,t)},g=(e,t)=>t.render?t.render(e):e[t.key];return c?(0,s.jsx)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-12 bg-surface-100 rounded-t-card"}),[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"h-16 bg-surface-50 border-t border-border-light"},t))]})}):(0,s.jsxs)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light overflow-hidden",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-border-default",children:[(0,s.jsx)("thead",{className:"bg-surface-100",children:(0,s.jsx)("tr",{children:r.map(e=>(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-tertiary uppercase tracking-wider ".concat(e.sortable?"cursor-pointer hover:bg-surface-200":""),onClick:()=>e.sortable&&v(e.key),children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("span",{children:e.label}),e.sortable&&(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(n.Z,{className:"h-3 w-3 ".concat((null==p?void 0:p.key)===e.key&&(null==p?void 0:p.direction)==="asc"?"text-primary-500":"text-text-quaternary")}),(0,s.jsx)(i.Z,{className:"h-3 w-3 -mt-1 ".concat((null==p?void 0:p.key)===e.key&&(null==p?void 0:p.direction)==="desc"?"text-primary-500":"text-text-quaternary")})]})]})},e.key))})}),(0,s.jsxs)("tbody",{className:"bg-surface-0 divide-y divide-border-light",children:[t.map((e,t)=>(0,s.jsx)("tr",{className:"".concat(x?"cursor-pointer hover:bg-surface-50":""),onClick:()=>null==x?void 0:x(e),children:r.map(t=>(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary",children:g(e,t)},t.key))},t)),0===t.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:r.length,className:"px-6 py-12 text-center text-text-tertiary",children:"No data available"})})]})]})}),o&&(0,s.jsx)("div",{className:"bg-surface-0 px-4 py-3 border-t border-border-default sm:px-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,s.jsx)("button",{onClick:()=>null==m?void 0:m(o.pageNumber-1),disabled:o.pageNumber<=1,className:"relative inline-flex items-center px-4 py-2 border border-border-default text-sm font-medium rounded-button text-text-secondary bg-surface-0 hover:bg-surface-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,s.jsx)("button",{onClick:()=>null==m?void 0:m(o.pageNumber+1),disabled:o.pageNumber>=(o.totalPages||Math.ceil((o.totalCount||0)/(o.pageSize||1))),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-border-default text-sm font-medium rounded-button text-text-secondary bg-surface-0 hover:bg-surface-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),(0,s.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-sm text-text-secondary",children:["Showing"," ",(0,s.jsx)("span",{className:"font-medium",children:(o.pageNumber-1)*o.pageSize+1})," ","to"," ",(0,s.jsx)("span",{className:"font-medium",children:Math.min(o.pageNumber*o.pageSize,o.totalCount)})," ","of"," ",(0,s.jsx)("span",{className:"font-medium",children:o.totalCount})," results"]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[(0,s.jsx)("button",{onClick:()=>null==m?void 0:m(o.pageNumber-1),disabled:o.pageNumber<=1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-border-default bg-surface-0 text-sm font-medium text-text-tertiary hover:bg-surface-50 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(l.Z,{className:"h-5 w-5"})}),[...Array(o.totalPages||Math.ceil((o.totalCount||0)/(o.pageSize||1)))].map((e,t)=>{let r=t+1;return(0,s.jsx)("button",{onClick:()=>null==m?void 0:m(r),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(r===o.pageNumber?"z-10 bg-primary-50 border-primary-500 text-primary-600":"bg-surface-0 border-border-default text-text-tertiary hover:bg-surface-50"),children:r},r)}),(0,s.jsx)("button",{onClick:()=>null==m?void 0:m(o.pageNumber+1),disabled:o.pageNumber>=(o.totalPages||Math.ceil((o.totalCount||0)/(o.pageSize||1))),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-border-default bg-surface-0 text-sm font-medium text-text-tertiary hover:bg-surface-50 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(d.Z,{className:"h-5 w-5"})})]})})]})]})})]})}},88013:function(e,t,r){"use strict";r.d(t,{R:function(){return a}});var s=r(51034);class a{async get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.Nv)(()=>s.ZP.get("".concat(this.endpoint).concat(e)))}async post(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,s.Nv)(()=>s.ZP.post("".concat(this.endpoint).concat(e),t))}async put(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,s.Nv)(()=>s.ZP.put("".concat(this.endpoint).concat(e),t))}async patch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,s.Nv)(()=>s.ZP.patch("".concat(this.endpoint).concat(e),t))}async deleteRequest(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.Nv)(()=>s.ZP.delete("".concat(this.endpoint).concat(e)))}async getAll(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[r,s]=e;null!=s&&t.append(r,s.toString())});let r=t.toString()?"?".concat(t):"";return this.get(r)}async getById(e){return this.get("/".concat(e))}async create(e){return this.post("",e)}async update(e,t){return this.put("/".concat(e),t)}async delete(e){return this.deleteRequest("/".concat(e))}async bulkAction(e,t,r){return this.post("/bulk-action",{action:e,ids:t,data:r})}constructor(e){this.endpoint=e}}},39466:function(e,t,r){"use strict";r.d(t,{y:function(){return a}});var s=r(88013);class a extends s.R{async getAllVendors(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[r,s]=e;null!=s&&""!==s&&t.append(r,s.toString())});let r=t.toString()?"?".concat(t):"";return this.get(r)}async getVendorById(e){return this.get("/".concat(e))}async approveVendor(e,t){return this.put("/".concat(e,"/approve"),t)}async rejectVendor(e,t){return this.put("/".concat(e,"/reject"),t)}async suspendVendor(e,t){return this.put("/".concat(e,"/suspend"),t)}async activateVendor(e,t){return this.put("/".concat(e,"/activate"),t)}async updateVendorStatus(e,t){return this.put("/".concat(e,"/status"),t)}async getVendorZoneAssignments(e){return this.get("/".concat(e,"/zones"))}async getAvailableZones(){return this.get("/zones/available")}async assignVendorToZone(e,t){return this.post("/".concat(e,"/assign-zone"),t)}async removeVendorFromZone(e,t){return this.deleteRequest("/".concat(e,"/zones/").concat(t))}async sendInstruction(e,t){return this.post("/".concat(e,"/instructions"),t)}async sendBackToPending(e,t){return this.post("/".concat(e,"/send-back-to-pending"),{message:t.trim()})}async getVendorStats(e,t){let r=new URLSearchParams;e&&r.append("dateFrom",e),t&&r.append("dateTo",t);let s="/stats".concat(r.toString()?"?".concat(r):"");return this.get(s)}async getVendorActivities(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return this.get("/".concat(e,"/activities?limit=").concat(t))}async bulkApprove(e,t){return this.bulkAction("approve",e,{reason:t})}async bulkReject(e,t){return this.bulkAction("reject",e,{reason:t})}async bulkSuspend(e,t){return this.bulkAction("suspend",e,{reason:t})}async forceCloseAllVendorStores(){return this.post("/force-close-all",{})}constructor(){super("api/admin/vendors")}}},98438:function(e,t,r){"use strict";r.d(t,{C6:function(){return o},Fv:function(){return b},Hq:function(){return y},IL:function(){return v},Kx:function(){return u},MI:function(){return m},OB:function(){return h},PY:function(){return j},Rd:function(){return d},UN:function(){return g},_n:function(){return f},at:function(){return c},cl:function(){return x},tG:function(){return p}});var s=r(11713),a=r(29827),n=r(21770);let i=new(r(39466)).y,l={all:["vendors"],lists:()=>[...l.all,"list"],list:e=>[...l.lists(),e],details:()=>[...l.all,"detail"],detail:e=>[...l.details(),e],zones:e=>[...l.detail(e),"zones"],stats:(e,t)=>[...l.all,"stats",e,t],activities:(e,t)=>[...l.detail(e),"activities",t]};function d(e){return(0,s.a)({queryKey:l.list(e),queryFn:()=>i.getAllVendors(e),staleTime:12e4,refetchInterval:3e5,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)})}function c(e){return(0,s.a)({queryKey:l.detail(e),queryFn:()=>i.getVendorById(e),staleTime:3e5,enabled:!!e,retry:2})}function o(e){return(0,s.a)({queryKey:l.zones(e),queryFn:()=>i.getVendorZoneAssignments(e),staleTime:3e5,enabled:!!e,retry:2})}function u(){return(0,s.a)({queryKey:["availableZones"],queryFn:()=>i.getAvailableZones(),staleTime:6e5,refetchInterval:9e5,retry:2})}function m(e,t){return(0,s.a)({queryKey:l.stats(e,t),queryFn:()=>i.getVendorStats(e,t),staleTime:6e5,refetchInterval:9e5,retry:2})}function x(){let e=(0,a.NL)();return(0,n.D)({mutationFn:e=>{let{vendorId:t,request:r}=e;return i.approveVendor(t,r)},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.detail(r.vendorId)}),e.invalidateQueries({queryKey:l.stats()})}})}function p(){let e=(0,a.NL)();return(0,n.D)({mutationFn:e=>{let{vendorId:t,request:r}=e;return i.rejectVendor(t,r)},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.detail(r.vendorId)}),e.invalidateQueries({queryKey:l.stats()})}})}function h(){let e=(0,a.NL)();return(0,n.D)({mutationFn:e=>{let{vendorId:t,request:r}=e;return i.suspendVendor(t,r)},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.detail(r.vendorId)}),e.invalidateQueries({queryKey:l.stats()})}})}function v(){let e=(0,a.NL)();return(0,n.D)({mutationFn:e=>{let{vendorId:t,request:r}=e;return i.activateVendor(t,r)},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.detail(r.vendorId)}),e.invalidateQueries({queryKey:l.stats()})}})}function g(){let e=(0,a.NL)();return(0,n.D)({mutationFn:e=>{let{vendorId:t,request:r}=e;return i.assignVendorToZone(t,r)},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:l.detail(r.vendorId)}),e.invalidateQueries({queryKey:l.zones(r.vendorId)})}})}function y(){let e=(0,a.NL)();return(0,n.D)({mutationFn:e=>{let{vendorId:t,zoneId:r}=e;return i.removeVendorFromZone(t,r)},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:l.detail(r.vendorId)}),e.invalidateQueries({queryKey:l.zones(r.vendorId)})}})}function b(){let e=(0,a.NL)();return(0,n.D)({mutationFn:e=>{let{vendorId:t,request:r}=e;return i.sendInstruction(t,r)},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:l.activities(r.vendorId)})}})}function f(){let e=(0,a.NL)();return(0,n.D)({mutationFn:e=>{let{vendorId:t,message:r}=e;return i.sendBackToPending(t,r)},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.detail(r.vendorId)}),e.invalidateQueries({queryKey:l.stats()}),e.invalidateQueries({queryKey:l.activities(r.vendorId)})}})}function j(){let e=(0,a.NL)();return(0,n.D)({mutationFn:()=>i.forceCloseAllVendorStores(),onSuccess:()=>{e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.stats()})}})}}},function(e){e.O(0,[3464,9763,1713,6977,2324,4297,3381,1021,9974,290,73,2971,2117,1744],function(){return e(e.s=78928)}),_N_E=e.O()}]);