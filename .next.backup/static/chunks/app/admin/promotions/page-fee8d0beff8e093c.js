(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[999],{38077:function(e,t,r){Promise.resolve().then(r.bind(r,10840))},10840:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return et}});var s=r(57437),a=r(2265),i=r(42548),o=r(12594),n=r(60007),d=r(59035),l=r(61601),c=r(65001),m=r(78931),u=r(55026),x=r(11713),p=r(29827),h=r(21770),b=r(88013),g=r(51034);class v extends b.R{async getPromotions(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[r,s]=e;null!=s&&""!==s&&t.append(r,s.toString())});let r=t.toString()?"?".concat(t):"";return this.get(r)}async getPromotion(e){return this.get("/".concat(e))}async getPromotionStats(){return this.get("/stats")}async createPromotion(e){return this.post("",e)}async updatePromotion(e,t){return this.put("/".concat(e),t)}async deletePromotion(e){return this.delete("/".concat(e))}async togglePromotionStatus(e){return this.patch("/".concat(e,"/toggle-status"),{})}async createBulkPromotions(e){return this.post("/bulk",e)}async bulkDeletePromotions(e){return(0,g.Nv)(()=>g.ZP.delete("/api/admin/product-promotions/bulk",{data:e}))}async bulkDeactivatePromotions(e){return this.patch("/bulk/deactivate",e)}async getEligibleProducts(e){let t=new URLSearchParams;(null==e?void 0:e.vendorId)&&t.append("vendorId",e.vendorId),(null==e?void 0:e.categoryId)&&t.append("categoryId",e.categoryId),(null==e?void 0:e.excludeExisting)!==void 0&&t.append("excludeExisting",e.excludeExisting.toString()),(null==e?void 0:e.search)&&t.append("search",e.search);let r=t.toString()?"/eligible-products?".concat(t):"/eligible-products";return this.get(r)}async getVendors(){return this.get("/../vendors/dropdown")}async getCategories(){return this.get("/../categories/dropdown")}constructor(){super("/api/admin/product-promotions")}}let y=new v,f={all:["promotions"],lists:()=>[...f.all,"list"],list:e=>[...f.lists(),e],details:()=>[...f.all,"detail"],detail:e=>[...f.details(),e],stats:()=>[...f.all,"stats"],eligibleProducts:()=>[...f.all,"eligible-products"],vendors:()=>[...f.all,"vendors"],categories:()=>[...f.all,"categories"]},j=e=>(0,x.a)({queryKey:f.list(e),queryFn:()=>y.getPromotions(e),staleTime:3e5}),N=()=>(0,x.a)({queryKey:f.stats(),queryFn:()=>y.getPromotionStats(),staleTime:3e5}),w=e=>(0,x.a)({queryKey:[...f.eligibleProducts(),e],queryFn:()=>y.getEligibleProducts(e),enabled:!!((null==e?void 0:e.search)||(null==e?void 0:e.vendorId)||(null==e?void 0:e.categoryId)||(null==e?void 0:e.excludeExisting)),staleTime:12e4}),P=()=>(0,x.a)({queryKey:f.vendors(),queryFn:()=>y.getVendors(),staleTime:6e5}),D=()=>(0,x.a)({queryKey:f.categories(),queryFn:()=>y.getCategories(),staleTime:6e5}),k=()=>{let e=(0,p.NL)();return(0,h.D)({mutationFn:e=>y.createPromotion(e),onSuccess:()=>{e.invalidateQueries({queryKey:f.lists()}),e.invalidateQueries({queryKey:f.stats()}),e.invalidateQueries({queryKey:f.eligibleProducts()})}})},C=()=>{let e=(0,p.NL)();return(0,h.D)({mutationFn:e=>{let{id:t,data:r}=e;return y.updatePromotion(t,r)},onSuccess:(t,r)=>{let{id:s}=r;e.invalidateQueries({queryKey:f.lists()}),e.invalidateQueries({queryKey:f.detail(s)}),e.invalidateQueries({queryKey:f.stats()})}})},A=()=>{let e=(0,p.NL)();return(0,h.D)({mutationFn:e=>y.deletePromotion(e),onSuccess:()=>{e.invalidateQueries({queryKey:f.lists()}),e.invalidateQueries({queryKey:f.stats()}),e.invalidateQueries({queryKey:f.eligibleProducts()})}})},S=()=>{let e=(0,p.NL)();return(0,h.D)({mutationFn:e=>y.togglePromotionStatus(e),onSuccess:()=>{e.invalidateQueries({queryKey:f.lists()}),e.invalidateQueries({queryKey:f.stats()})}})},I=()=>{let e=(0,p.NL)();return(0,h.D)({mutationFn:e=>y.createBulkPromotions(e),onSuccess:()=>{e.invalidateQueries({queryKey:f.lists()}),e.invalidateQueries({queryKey:f.stats()}),e.invalidateQueries({queryKey:f.eligibleProducts()})}})},Z=()=>{let e=(0,p.NL)();return(0,h.D)({mutationFn:e=>y.bulkDeletePromotions(e),onSuccess:()=>{e.invalidateQueries({queryKey:f.lists()}),e.invalidateQueries({queryKey:f.stats()}),e.invalidateQueries({queryKey:f.eligibleProducts()})}})};var F=r(90173),E=r(81801),O=r(41556),T=r(52700),q=r(73910),L=r(8226),K=r(19157),V=r(41021);function R(e){let{filters:t,onFiltersChange:r,onCreateClick:x,onEditClick:p,onDetailsClick:h,onBulkPromotionClick:b,isLoading:g=!1}=e,[v,y]=(0,a.useState)([]),{data:f,refetch:N}=j(t),w=S(),P=A(),D=Z(),k=(null==f?void 0:f.items)||[],C=f?{pageNumber:f.pageNumber,pageSize:f.pageSize,totalCount:f.totalCount}:void 0,I=async e=>{try{await w.mutateAsync(e.id),V.ZP.success("Promotion ".concat(e.isActive?"deactivated":"activated"," successfully"))}catch(e){V.ZP.error("Failed to toggle promotion status")}},R=async e=>{if(window.confirm("Are you sure you want to delete this promotion?"))try{await P.mutateAsync(e.id),V.ZP.success("Promotion deleted successfully")}catch(e){V.ZP.error("Failed to delete promotion")}},B=async()=>{if(0===v.length){V.ZP.warning("Please select promotions to delete");return}if(window.confirm("Are you sure you want to delete ".concat(v.length," promotion(s)?")))try{await D.mutateAsync(v),V.ZP.success("".concat(v.length," promotion(s) deleted successfully")),y([])}catch(e){V.ZP.error("Failed to delete selected promotions")}},Q=(e,t,r)=>{let a=new Date,i="Inactive",o="bg-gray-100 text-gray-800";if(e){let e=t?new Date(t):null,s=r?new Date(r):null;e&&e>a?(i="Scheduled",o="bg-blue-100 text-blue-800"):s&&s<a?(i="Expired",o="bg-orange-100 text-orange-800"):(i="Active",o="bg-green-100 text-green-800")}return(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(o),children:i})},z=e=>{var t;let r=e.discountPercentage?"".concat((100*e.discountPercentage).toFixed(0),"% OFF"):"₦".concat(null===(t=e.discountAmount)||void 0===t?void 0:t.toLocaleString()," OFF");return(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:r})},M=e=>"₦".concat(e.toLocaleString()),_=e=>e?new Date(e).toLocaleDateString():"N/A",[$,U]=(0,a.useState)(null),[G,W]=(0,a.useState)(""),H=e=>{let s="asc";$&&$.key===e&&"asc"===$.direction&&(s="desc"),U({key:e,direction:s}),r({...t,sortBy:e,sortOrder:s,pageNumber:1})},Y=e=>{W(e),r({...t,search:e,pageNumber:1})},J=e=>(null==$?void 0:$.key)===e?"asc"===$.direction?(0,s.jsx)(F.Z,{className:"h-4 w-4 text-primary-500"}):(0,s.jsx)(E.Z,{className:"h-4 w-4 text-primary-500"}):(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(F.Z,{className:"h-3 w-3 text-text-quaternary"}),(0,s.jsx)(E.Z,{className:"h-3 w-3 -mt-1 text-text-quaternary"})]}),X=[{key:"productName",label:"Product",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"discount",label:"Discount",sortable:!1},{key:"pricing",label:"Pricing",sortable:!0},{key:"duration",label:"Duration",sortable:!1},{key:"status",label:"Status",sortable:!0},{key:"createdAt",label:"Created",sortable:!0},{key:"actions",label:"Actions",sortable:!1}],ee=[{icon:i.Z,label:"View Details",onClick:h,condition:()=>K.$.hasPermission(L.y3.VIEW_PROMOTIONS)},{icon:o.Z,label:"Edit",onClick:p,condition:()=>K.$.hasPermission(L.y3.EDIT_PROMOTION)},{icon:e=>e.isActive?n.Z:d.Z,label:e=>e.isActive?"Deactivate":"Activate",onClick:I,condition:()=>K.$.hasPermission(L.y3.TOGGLE_PROMOTION)},{icon:l.Z,label:"Delete",onClick:R,condition:()=>K.$.hasPermission(L.y3.DELETE_PROMOTION),className:"text-red-600 hover:text-red-900"}],et=[{label:"Create Promotion",onClick:x,icon:c.Z,variant:"primary",condition:()=>K.$.hasPermission(L.y3.CREATE_PROMOTION)},{label:"Bulk Promotions",onClick:b,icon:m.Z,variant:"secondary",condition:()=>K.$.hasPermission(L.y3.BULK_MANAGE_PROMOTIONS)},{label:"Refresh",onClick:()=>N(),icon:u.Z,variant:"ghost"}];return g?(0,s.jsx)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-16 bg-surface-100 rounded-t-card"}),[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"h-20 bg-surface-50 border-t border-border-light"},t))]})}):(0,s.jsxs)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-border-light",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsx)("div",{className:"flex-1 max-w-md",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(O.Z,{className:"h-5 w-5 text-text-tertiary absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,s.jsx)("input",{type:"text",placeholder:"Search promotions...",value:G,onChange:e=>Y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]})}),(0,s.jsx)("div",{className:"flex items-center space-x-3",children:et.map((e,t)=>e.condition&&!e.condition()?null:(0,s.jsxs)("button",{onClick:e.onClick,className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors ".concat("primary"===e.variant?"bg-primary-600 text-white hover:bg-primary-700":"secondary"===e.variant?"bg-surface-100 text-text-primary hover:bg-surface-200 border border-border-default":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"),children:[(0,s.jsx)(e.icon,{className:"h-4 w-4 mr-2"}),e.label]},t))})]}),v.length>0&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-primary-50 border border-primary-200 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-sm text-primary-700",children:[v.length," promotion(s) selected"]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[[{label:"Delete Selected",onClick:B,condition:()=>K.$.hasPermission(L.y3.DELETE_PROMOTION),className:"text-red-600 hover:text-red-700"}].map((e,t)=>e.condition&&!e.condition()?null:(0,s.jsx)("button",{onClick:e.onClick,className:"text-sm font-medium px-3 py-1 rounded transition-colors ".concat(e.className||"text-primary-600 hover:text-primary-700"),children:e.label},t)),(0,s.jsx)("button",{onClick:()=>y([]),className:"text-sm text-text-secondary hover:text-text-primary",children:"Clear"})]})]})})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-border-light",children:[(0,s.jsx)("thead",{className:"bg-surface-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left",children:(0,s.jsx)("input",{type:"checkbox",checked:v.length===k.length&&k.length>0,onChange:e=>{e.target.checked?y(k.map(e=>e.id)):y([])},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-border-default rounded"})}),X.map(e=>(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-tertiary uppercase tracking-wider ".concat(e.sortable?"cursor-pointer hover:bg-surface-200":""),onClick:()=>e.sortable&&H(e.key),children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("span",{children:e.label}),e.sortable&&J(e.key)]})},e.key))]})}),(0,s.jsxs)("tbody",{className:"bg-surface-0 divide-y divide-border-light",children:[k.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-surface-50",children:[(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("input",{type:"checkbox",checked:v.includes(e.id),onChange:t=>{t.target.checked?y([...v,e.id]):y(v.filter(t=>t!==e.id))},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-border-default rounded"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"h-10 w-10 bg-primary-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(c.Z,{className:"h-5 w-5 text-primary-600"})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-text-primary truncate",children:e.productName}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:e.vendorName})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"text-sm text-text-primary",children:e.categoryName})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:z(e)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("div",{className:"line-through text-text-tertiary",children:M(e.basePrice)}),(0,s.jsx)("div",{className:"font-medium text-text-primary",children:M(e.discountedPrice)})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"text-sm text-text-secondary",children:[(0,s.jsx)("div",{children:_(e.startDate)}),(0,s.jsxs)("div",{children:["to ",_(e.endDate)]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:Q(e.isActive,e.startDate,e.endDate)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"text-sm text-text-secondary",children:_(e.createdAt)})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsx)("div",{className:"flex items-center space-x-2",children:ee.map((t,r)=>{if(t.condition&&!t.condition())return null;let a="function"==typeof t.icon?t.icon(e):t.icon,i="function"==typeof t.label?t.label(e):t.label;return(0,s.jsx)("button",{onClick:()=>t.onClick(e),className:"p-2 rounded-md transition-colors ".concat(t.className||"text-text-secondary hover:text-text-primary hover:bg-surface-hover"),title:i,children:(0,s.jsx)(a,{className:"h-4 w-4"})},r)})})})]},e.id)),0===k.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:X.length+1,className:"px-6 py-12 text-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,s.jsx)(c.Z,{className:"h-12 w-12 text-text-quaternary"}),(0,s.jsxs)("div",{className:"text-sm text-text-secondary",children:[(0,s.jsx)("p",{className:"font-medium",children:"No promotions found"}),(0,s.jsx)("p",{children:"Create your first promotion to get started."})]}),(0,s.jsx)("button",{onClick:x,className:"mt-2 px-4 py-2 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-md transition-colors",children:"Create Promotion"})]})})})]})]})}),C&&(0,s.jsx)("div",{className:"bg-surface-0 px-4 py-3 border-t border-border-light sm:px-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,s.jsx)("button",{onClick:()=>r({...t,pageNumber:C.pageNumber-1}),disabled:C.pageNumber<=1,className:"relative inline-flex items-center px-4 py-2 border border-border-default text-sm font-medium rounded-button text-text-secondary bg-surface-0 hover:bg-surface-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,s.jsx)("button",{onClick:()=>r({...t,pageNumber:C.pageNumber+1}),disabled:C.pageNumber>=Math.ceil(C.totalCount/C.pageSize),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-border-default text-sm font-medium rounded-button text-text-secondary bg-surface-0 hover:bg-surface-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),(0,s.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-sm text-text-secondary",children:["Showing"," ",(0,s.jsx)("span",{className:"font-medium",children:(C.pageNumber-1)*C.pageSize+1})," ","to"," ",(0,s.jsx)("span",{className:"font-medium",children:Math.min(C.pageNumber*C.pageSize,C.totalCount)})," ","of"," ",(0,s.jsx)("span",{className:"font-medium",children:C.totalCount})," results"]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[(0,s.jsx)("button",{onClick:()=>r({...t,pageNumber:C.pageNumber-1}),disabled:C.pageNumber<=1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-border-default bg-surface-0 text-sm font-medium text-text-tertiary hover:bg-surface-50 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(T.Z,{className:"h-5 w-5"})}),[...Array(Math.ceil(C.totalCount/C.pageSize))].map((e,a)=>{let i=a+1;return(0,s.jsx)("button",{onClick:()=>r({...t,pageNumber:i}),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(i===C.pageNumber?"z-10 bg-primary-50 border-primary-500 text-primary-600":"bg-surface-0 border-border-default text-text-tertiary hover:bg-surface-50"),children:i},i)}),(0,s.jsx)("button",{onClick:()=>r({...t,pageNumber:C.pageNumber+1}),disabled:C.pageNumber>=Math.ceil(C.totalCount/C.pageSize),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-border-default bg-surface-0 text-sm font-medium text-text-tertiary hover:bg-surface-50 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(q.Z,{className:"h-5 w-5"})})]})})]})]})})]})}var B=r(94565),Q=r(94725),z=r(41077),M=r(77165);function _(e){var t,r;let i;let{filters:o,onFiltersChange:n}=e,[d,l]=(0,a.useState)(!1),[m,u]=(0,a.useState)(o),{data:x}=P(),{data:p}=D();(0,a.useEffect)(()=>{u(o)},[o]);let h=(e,t)=>{let r={...m,[e]:t,pageNumber:1};u(r),n(r)};return(0,s.jsxs)("div",{className:"bg-surface-0 rounded-card shadow-soft border border-border-light",children:[(0,s.jsx)("div",{className:"p-4 border-b border-border-light",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(B.Z,{className:"h-5 w-5 text-text-secondary"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-text-primary",children:"Filters"}),!!(o.vendorId||o.categoryId||void 0!==o.isActive||o.startDateFrom||o.startDateTo||o.endDateFrom||o.endDateTo||o.search)&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:[(i=0,o.vendorId&&i++,o.categoryId&&i++,void 0!==o.isActive&&i++,o.startDateFrom&&i++,o.startDateTo&&i++,o.endDateFrom&&i++,o.endDateTo&&i++,o.search&&i++,i)," active"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[!!(o.vendorId||o.categoryId||void 0!==o.isActive||o.startDateFrom||o.startDateTo||o.endDateFrom||o.endDateTo||o.search)&&(0,s.jsx)("button",{onClick:()=>{let e={pageNumber:1,pageSize:o.pageSize,sortBy:"createdAt",sortOrder:"desc"};u(e),n(e)},className:"text-sm text-text-secondary hover:text-text-primary transition-colors",children:"Clear all"}),(0,s.jsx)("button",{onClick:()=>l(!d),className:"text-sm text-primary-600 hover:text-primary-700 font-medium transition-colors",children:d?"Hide filters":"Show filters"})]})]})}),d&&(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:[(0,s.jsx)(Q.Z,{className:"h-4 w-4 inline mr-1"}),"Vendor"]}),(0,s.jsxs)("select",{value:m.vendorId||"",onChange:e=>h("vendorId",e.target.value||void 0),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",children:[(0,s.jsx)("option",{value:"",children:"All Vendors"}),null==x?void 0:x.map(e=>(0,s.jsx)("option",{value:e.id,children:e.businessName},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 inline mr-1"}),"Category"]}),(0,s.jsxs)("select",{value:m.categoryId||"",onChange:e=>h("categoryId",e.target.value||void 0),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",children:[(0,s.jsx)("option",{value:"",children:"All Categories"}),null==p?void 0:p.map(e=>(0,s.jsx)("option",{value:e.id,children:e.categoryName},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Status"}),(0,s.jsxs)("select",{value:void 0===m.isActive?"":m.isActive.toString(),onChange:e=>{let t=e.target.value;h("isActive",""===t?void 0:"true"===t)},className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",children:[(0,s.jsx)("option",{value:"",children:"All Statuses"}),(0,s.jsx)("option",{value:"true",children:"Active"}),(0,s.jsx)("option",{value:"false",children:"Inactive"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Sort By"}),(0,s.jsxs)("select",{value:"".concat(m.sortBy||"createdAt","-").concat(m.sortOrder||"desc"),onChange:e=>{let[t,r]=e.target.value.split("-");h("sortBy",t),h("sortOrder",r)},className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",children:[(0,s.jsx)("option",{value:"createdAt-desc",children:"Newest First"}),(0,s.jsx)("option",{value:"createdAt-asc",children:"Oldest First"}),(0,s.jsx)("option",{value:"productName-asc",children:"Product Name A-Z"}),(0,s.jsx)("option",{value:"productName-desc",children:"Product Name Z-A"}),(0,s.jsx)("option",{value:"discountedPrice-asc",children:"Price Low to High"}),(0,s.jsx)("option",{value:"discountedPrice-desc",children:"Price High to Low"}),(0,s.jsx)("option",{value:"startDate-desc",children:"Start Date (Latest)"}),(0,s.jsx)("option",{value:"endDate-asc",children:"End Date (Soonest)"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:[(0,s.jsx)(z.Z,{className:"h-4 w-4 inline mr-1"}),"Start Date From"]}),(0,s.jsx)("input",{type:"date",value:m.startDateFrom||"",onChange:e=>h("startDateFrom",e.target.value||void 0),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Start Date To"}),(0,s.jsx)("input",{type:"date",value:m.startDateTo||"",onChange:e=>h("startDateTo",e.target.value||void 0),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"End Date From"}),(0,s.jsx)("input",{type:"date",value:m.endDateFrom||"",onChange:e=>h("endDateFrom",e.target.value||void 0),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"End Date To"}),(0,s.jsx)("input",{type:"date",value:m.endDateTo||"",onChange:e=>h("endDateTo",e.target.value||void 0),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]})]}),!!(o.vendorId||o.categoryId||void 0!==o.isActive||o.startDateFrom||o.startDateTo||o.endDateFrom||o.endDateTo||o.search)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-border-light",children:[(0,s.jsx)("span",{className:"text-sm text-text-secondary",children:"Active filters:"}),o.vendorId&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Vendor: ",null==x?void 0:null===(t=x.find(e=>e.id===o.vendorId))||void 0===t?void 0:t.businessName,(0,s.jsx)("button",{onClick:()=>h("vendorId",void 0),className:"ml-1 h-3 w-3 rounded-full hover:bg-blue-200",children:(0,s.jsx)(M.Z,{className:"h-3 w-3"})})]}),o.categoryId&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["Category: ",null==p?void 0:null===(r=p.find(e=>e.id===o.categoryId))||void 0===r?void 0:r.categoryName,(0,s.jsx)("button",{onClick:()=>h("categoryId",void 0),className:"ml-1 h-3 w-3 rounded-full hover:bg-green-200",children:(0,s.jsx)(M.Z,{className:"h-3 w-3"})})]}),void 0!==o.isActive&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["Status: ",o.isActive?"Active":"Inactive",(0,s.jsx)("button",{onClick:()=>h("isActive",void 0),className:"ml-1 h-3 w-3 rounded-full hover:bg-purple-200",children:(0,s.jsx)(M.Z,{className:"h-3 w-3"})})]})]})]})]})}var $=r(60962),U=r(16546),G=r(47842);function W(e){let{isOpen:t,onClose:r,promotion:i}=e,[o,n]=(0,a.useState)({productId:"",isActive:!0,description:""}),[d,l]=(0,a.useState)("percentage"),[m,u]=(0,a.useState)({}),[x,p]=(0,a.useState)(null),[h,b]=(0,a.useState)(""),g=k(),v=C(),{data:y,isLoading:f}=w({search:h,excludeExisting:!(null==i?void 0:i.id)}),j=!!i;(0,a.useEffect)(()=>{t&&(i?(n({productId:i.productId,discountPercentage:i.discountPercentage,discountAmount:i.discountAmount,isActive:i.isActive,startDate:i.startDate?i.startDate.split("T")[0]:void 0,endDate:i.endDate?i.endDate.split("T")[0]:void 0,description:i.description||""}),l(i.discountPercentage?"percentage":"amount"),p({id:i.productId,productName:i.productName,basePrice:i.basePrice,vendorId:i.vendorId,vendorName:i.vendorName,categoryId:"",categoryName:i.categoryName,hasActivePromotion:!1})):(n({productId:"",isActive:!0,description:""}),l("percentage"),p(null),b("")),u({}))},[t,i]);let N=()=>{let e={};return o.productId||(e.productId="Product is required"),"percentage"===d?o.discountPercentage?(o.discountPercentage<=0||o.discountPercentage>1)&&(e.discountPercentage="Discount percentage must be between 1% and 100%"):e.discountPercentage="Discount percentage is required":o.discountAmount?o.discountAmount<=0?e.discountAmount="Discount amount must be greater than 0":x&&o.discountAmount>=x.basePrice&&(e.discountAmount="Discount amount cannot be greater than or equal to product price"):e.discountAmount="Discount amount is required",o.startDate&&o.endDate&&new Date(o.startDate)>=new Date(o.endDate)&&(e.endDate="End date must be after start date"),u(e),0===Object.keys(e).length},P=()=>x?"percentage"===d&&o.discountPercentage?x.basePrice*(1-o.discountPercentage):"amount"===d&&o.discountAmount?x.basePrice-o.discountAmount:x.basePrice:0,D=async e=>{if(e.preventDefault(),N())try{let e={...o,discountPercentage:"percentage"===d?o.discountPercentage:void 0,discountAmount:"amount"===d?o.discountAmount:void 0};j&&i?(await v.mutateAsync({id:i.id,data:e}),V.ZP.success("Promotion updated successfully")):(await g.mutateAsync(e),V.ZP.success("Promotion created successfully")),r()}catch(e){V.ZP.error(e.message||"Failed to save promotion")}},A=e=>{p(e),n(t=>({...t,productId:e.id})),b(""),u(e=>({...e,productId:""}))},S=e=>{l(e),n(t=>({...t,discountPercentage:"percentage"===e?t.discountPercentage:void 0,discountAmount:"amount"===e?t.discountAmount:void 0})),u(e=>({...e,discountPercentage:"",discountAmount:""}))};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-surface-0 rounded-card shadow-soft max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border-light",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"h-10 w-10 bg-primary-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(c.Z,{className:"h-6 w-6 text-primary-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-text-primary",children:j?"Edit Promotion":"Create New Promotion"}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:j?"Update promotion details":"Set up a new product promotion"})]})]}),(0,s.jsx)("button",{onClick:r,className:"p-2 hover:bg-surface-hover rounded-lg transition-colors",children:(0,s.jsx)(M.Z,{className:"h-5 w-5 text-text-secondary"})})]}),(0,s.jsxs)("form",{onSubmit:D,className:"p-6 space-y-6",children:[!j&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Product *"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search for products...",value:h,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(m.productId?"border-red-500":"border-border-default")}),h&&y&&y.length>0&&(0,s.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-surface-0 border border-border-default rounded-md shadow-lg max-h-60 overflow-y-auto",children:y.map(e=>(0,s.jsxs)("button",{type:"button",onClick:()=>A(e),className:"w-full text-left px-4 py-3 hover:bg-surface-hover border-b border-border-light last:border-b-0",children:[(0,s.jsx)("div",{className:"font-medium text-text-primary",children:e.productName}),(0,s.jsxs)("div",{className:"text-sm text-text-secondary",children:[e.vendorName," • ",e.categoryName," • ₦",e.basePrice.toLocaleString()]})]},e.id))})]}),x&&(0,s.jsxs)("div",{className:"mt-3 p-3 bg-primary-50 border border-primary-200 rounded-md",children:[(0,s.jsx)("div",{className:"font-medium text-text-primary",children:x.productName}),(0,s.jsxs)("div",{className:"text-sm text-text-secondary",children:[x.vendorName," • ",x.categoryName]}),(0,s.jsxs)("div",{className:"text-sm font-medium text-primary-600",children:["Base Price: ₦",x.basePrice.toLocaleString()]})]}),m.productId&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.productId})]}),j&&x&&(0,s.jsxs)("div",{className:"p-4 bg-gray-50 border border-border-light rounded-md",children:[(0,s.jsx)("h4",{className:"font-medium text-text-primary mb-2",children:"Product Details"}),(0,s.jsxs)("div",{className:"text-sm space-y-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Name:"})," ",x.productName]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Vendor:"})," ",x.vendorName]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Category:"})," ",x.categoryName]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Base Price:"})," ₦",x.basePrice.toLocaleString()]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-3",children:"Discount Type *"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>S("percentage"),className:"p-4 border rounded-lg text-left transition-all ".concat("percentage"===d?"border-primary-500 bg-primary-50 text-primary-700":"border-border-default hover:border-border-hover"),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)($.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Percentage"})]}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:"Discount as a percentage of the original price"})]}),(0,s.jsxs)("button",{type:"button",onClick:()=>S("amount"),className:"p-4 border rounded-lg text-left transition-all ".concat("amount"===d?"border-primary-500 bg-primary-50 text-primary-700":"border-border-default hover:border-border-hover"),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(U.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Fixed Amount"})]}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:"Fixed discount amount"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["percentage"===d?(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Discount Percentage *"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"number",min:"1",max:"100",step:"1",value:o.discountPercentage?100*o.discountPercentage:"",onChange:e=>n(t=>({...t,discountPercentage:e.target.value?parseFloat(e.target.value)/100:void 0})),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pr-10 ".concat(m.discountPercentage?"border-red-500":"border-border-default"),placeholder:"15"}),(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:(0,s.jsx)("span",{className:"text-text-secondary",children:"%"})})]}),m.discountPercentage&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.discountPercentage})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Discount Amount *"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"number",min:"1",step:"1",value:o.discountAmount||"",onChange:e=>n(t=>({...t,discountAmount:e.target.value?parseFloat(e.target.value):void 0})),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-8 ".concat(m.discountAmount?"border-red-500":"border-border-default"),placeholder:"5000"}),(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:(0,s.jsx)("span",{className:"text-text-secondary",children:"₦"})})]}),m.discountAmount&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.discountAmount})]}),x&&(0,s.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-green-800 mb-2",children:"Price Preview"}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-green-700",children:"Original Price:"}),(0,s.jsxs)("span",{className:"line-through text-green-600",children:["₦",x.basePrice.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,s.jsx)("span",{className:"text-green-800",children:"Discounted Price:"}),(0,s.jsxs)("span",{className:"text-green-800",children:["₦",P().toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-green-700",children:"You Save:"}),(0,s.jsxs)("span",{className:"text-green-700",children:["₦",(x.basePrice-P()).toLocaleString()]})]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:[(0,s.jsx)(z.Z,{className:"h-4 w-4 inline mr-1"}),"Start Date"]}),(0,s.jsx)("input",{type:"date",value:o.startDate||"",onChange:e=>n(t=>({...t,startDate:e.target.value||void 0})),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"End Date"}),(0,s.jsx)("input",{type:"date",value:o.endDate||"",onChange:e=>n(t=>({...t,endDate:e.target.value||void 0})),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(m.endDate?"border-red-500":"border-border-default")}),m.endDate&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.endDate})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Description"}),(0,s.jsx)("textarea",{value:o.description,onChange:e=>n(t=>({...t,description:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Optional description for this promotion..."})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("input",{type:"checkbox",id:"isActive",checked:o.isActive,onChange:e=>n(t=>({...t,isActive:e.target.checked})),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-border-default rounded"}),(0,s.jsx)("label",{htmlFor:"isActive",className:"text-sm font-medium text-text-primary",children:"Activate promotion immediately"})]}),!j&&(null==x?void 0:x.hasActivePromotion)&&(0,s.jsx)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,s.jsx)(G.Z,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"text-sm text-yellow-800",children:[(0,s.jsx)("p",{className:"font-medium",children:"Product has active promotion"}),(0,s.jsx)("p",{children:"Creating a new promotion will deactivate the existing one."})]})]})}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-border-light",children:[(0,s.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-text-secondary hover:text-text-primary border border-border-default rounded-md hover:bg-surface-hover transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:g.isPending||v.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g.isPending||v.isPending?"Saving...":j?"Update Promotion":"Create Promotion"})]})]})]})}):null}var H=r(25893);function Y(e){let{isOpen:t,onClose:r}=e,[i,o]=(0,a.useState)({productIds:[],description:""}),[n,d]=(0,a.useState)("specific"),[l,u]=(0,a.useState)("percentage"),[x,p]=(0,a.useState)({}),[h,b]=(0,a.useState)(""),[g,v]=(0,a.useState)([]),y=I(),{data:f}=w({search:h,vendorId:"vendor"===n?i.vendorId:void 0,categoryId:"category"===n?i.categoryId:void 0,excludeExisting:!0}),{data:j}=P(),{data:N}=D();(0,a.useEffect)(()=>{t&&(o({productIds:[],description:""}),d("specific"),u("percentage"),v([]),b(""),p({}))},[t]);let k=()=>{let e={};return"specific"===n&&0===i.productIds.length?e.productIds="At least one product must be selected":"vendor"!==n||i.vendorId?"category"!==n||i.categoryId||(e.categoryId="Category selection is required"):e.vendorId="Vendor selection is required","percentage"===l?i.discountPercentage?(i.discountPercentage<=0||i.discountPercentage>1)&&(e.discountPercentage="Discount percentage must be between 1% and 100%"):e.discountPercentage="Discount percentage is required":i.discountAmount?i.discountAmount<=0&&(e.discountAmount="Discount amount must be greater than 0"):e.discountAmount="Discount amount is required",i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&(e.endDate="End date must be after start date"),p(e),0===Object.keys(e).length},C=async e=>{if(e.preventDefault(),k())try{let e={...i,discountPercentage:"percentage"===l?i.discountPercentage:void 0,discountAmount:"amount"===l?i.discountAmount:void 0},t=await y.mutateAsync(e);V.ZP.success("Successfully created ".concat(t.createdCount," promotions")),r()}catch(e){V.ZP.error(e.message||"Failed to create bulk promotions")}},A=e=>{i.productIds.includes(e.id)?(o(t=>({...t,productIds:t.productIds.filter(t=>t!==e.id)})),v(t=>t.filter(t=>t.id!==e.id))):(o(t=>({...t,productIds:[...t.productIds,e.id]})),v(t=>[...t,e])),p(e=>({...e,productIds:""}))},S=e=>{d(e),o(e=>({...e,productIds:[],vendorId:void 0,categoryId:void 0})),v([]),b(""),p({})},Z=()=>"specific"===n?g.length:("vendor"===n&&i.vendorId||"category"===n&&i.categoryId)&&(null==f?void 0:f.length)||0;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-surface-0 rounded-card shadow-soft max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border-light",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"h-10 w-10 bg-primary-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(m.Z,{className:"h-6 w-6 text-primary-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-text-primary",children:"Create Bulk Promotions"}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:"Apply promotions to multiple products at once"})]})]}),(0,s.jsx)("button",{onClick:r,className:"p-2 hover:bg-surface-hover rounded-lg transition-colors",children:(0,s.jsx)(M.Z,{className:"h-5 w-5 text-text-secondary"})})]}),(0,s.jsxs)("form",{onSubmit:C,className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-3",children:"Target Products *"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>S("specific"),className:"p-4 border rounded-lg text-left transition-all ".concat("specific"===n?"border-primary-500 bg-primary-50 text-primary-700":"border-border-default hover:border-border-hover"),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(H.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Specific Products"})]}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:"Select individual products"})]}),(0,s.jsxs)("button",{type:"button",onClick:()=>S("vendor"),className:"p-4 border rounded-lg text-left transition-all ".concat("vendor"===n?"border-primary-500 bg-primary-50 text-primary-700":"border-border-default hover:border-border-hover"),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(Q.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"font-medium",children:"By Vendor"})]}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:"All products from a vendor"})]}),(0,s.jsxs)("button",{type:"button",onClick:()=>S("category"),className:"p-4 border rounded-lg text-left transition-all ".concat("category"===n?"border-primary-500 bg-primary-50 text-primary-700":"border-border-default hover:border-border-hover"),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"font-medium",children:"By Category"})]}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:"All products in a category"})]})]})]}),"specific"===n&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Select Products *"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search for products...",value:h,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),f&&f.length>0&&(0,s.jsx)("div",{className:"border border-border-default rounded-md max-h-60 overflow-y-auto",children:f.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-3 p-3 hover:bg-surface-hover border-b border-border-light last:border-b-0 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:i.productIds.includes(e.id),onChange:()=>A(e),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-border-default rounded"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-text-primary",children:e.productName}),(0,s.jsxs)("div",{className:"text-sm text-text-secondary",children:[e.vendorName," • ",e.categoryName," • ₦",e.basePrice.toLocaleString()]})]})]},e.id))}),g.length>0&&(0,s.jsxs)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:[(0,s.jsxs)("p",{className:"text-sm font-medium text-blue-800 mb-2",children:["Selected Products (",g.length,")"]}),(0,s.jsx)("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:g.map(e=>(0,s.jsxs)("div",{className:"text-sm text-blue-700",children:[e.productName," - ₦",e.basePrice.toLocaleString()]},e.id))})]})]}),x.productIds&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.productIds})]}),"vendor"===n&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Select Vendor *"}),(0,s.jsxs)("select",{value:i.vendorId||"",onChange:e=>o(t=>({...t,vendorId:e.target.value||void 0})),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.vendorId?"border-red-500":"border-border-default"),children:[(0,s.jsx)("option",{value:"",children:"Choose a vendor..."}),null==j?void 0:j.map(e=>(0,s.jsx)("option",{value:e.id,children:e.businessName},e.id))]}),x.vendorId&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.vendorId})]}),"category"===n&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Select Category *"}),(0,s.jsxs)("select",{value:i.categoryId||"",onChange:e=>o(t=>({...t,categoryId:e.target.value||void 0})),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.categoryId?"border-red-500":"border-border-default"),children:[(0,s.jsx)("option",{value:"",children:"Choose a category..."}),null==N?void 0:N.map(e=>(0,s.jsx)("option",{value:e.id,children:e.categoryName},e.id))]}),x.categoryId&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.categoryId})]}),Z()>0&&(0,s.jsx)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:(0,s.jsxs)("p",{className:"text-sm text-green-800",children:[(0,s.jsx)("span",{className:"font-medium",children:"Estimated products:"})," ",Z()," products will receive this promotion"]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-3",children:"Discount Type *"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>u("percentage"),className:"p-4 border rounded-lg text-left transition-all ".concat("percentage"===l?"border-primary-500 bg-primary-50 text-primary-700":"border-border-default hover:border-border-hover"),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)($.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Percentage"})]}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:"Discount as a percentage"})]}),(0,s.jsxs)("button",{type:"button",onClick:()=>u("amount"),className:"p-4 border rounded-lg text-left transition-all ".concat("amount"===l?"border-primary-500 bg-primary-50 text-primary-700":"border-border-default hover:border-border-hover"),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(U.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Fixed Amount"})]}),(0,s.jsx)("p",{className:"text-sm text-text-secondary",children:"Fixed discount amount"})]})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:"percentage"===l?(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Discount Percentage *"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"number",min:"1",max:"100",step:"1",value:i.discountPercentage?100*i.discountPercentage:"",onChange:e=>o(t=>({...t,discountPercentage:e.target.value?parseFloat(e.target.value)/100:void 0})),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pr-10 ".concat(x.discountPercentage?"border-red-500":"border-border-default"),placeholder:"15"}),(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:(0,s.jsx)("span",{className:"text-text-secondary",children:"%"})})]}),x.discountPercentage&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.discountPercentage})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Discount Amount *"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"number",min:"1",step:"1",value:i.discountAmount||"",onChange:e=>o(t=>({...t,discountAmount:e.target.value?parseFloat(e.target.value):void 0})),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-8 ".concat(x.discountAmount?"border-red-500":"border-border-default"),placeholder:"5000"}),(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:(0,s.jsx)("span",{className:"text-text-secondary",children:"₦"})})]}),x.discountAmount&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.discountAmount})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:[(0,s.jsx)(z.Z,{className:"h-4 w-4 inline mr-1"}),"Start Date"]}),(0,s.jsx)("input",{type:"date",value:i.startDate||"",onChange:e=>o(t=>({...t,startDate:e.target.value||void 0})),className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"End Date"}),(0,s.jsx)("input",{type:"date",value:i.endDate||"",onChange:e=>o(t=>({...t,endDate:e.target.value||void 0})),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(x.endDate?"border-red-500":"border-border-default")}),x.endDate&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.endDate})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Description"}),(0,s.jsx)("textarea",{value:i.description,onChange:e=>o(t=>({...t,description:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-border-default rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Optional description for these promotions..."})]}),(0,s.jsx)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,s.jsx)(G.Z,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"text-sm text-yellow-800",children:[(0,s.jsx)("p",{className:"font-medium",children:"Important"}),(0,s.jsx)("p",{children:"Any existing active promotions on the selected products will be deactivated and replaced with this new promotion."})]})]})}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-border-light",children:[(0,s.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-text-secondary hover:text-text-primary border border-border-default rounded-md hover:bg-surface-hover transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:y.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y.isPending?"Creating Promotions...":"Create ".concat(Z()," Promotions")})]})]})]})}):null}var J=r(20322);function X(e){let{stats:t}=e,r=e=>"₦".concat(e.toLocaleString()),a=[{title:"Total Promotions",value:(null==t?void 0:t.totalPromotions)||0,icon:c.Z,color:"bg-blue-100 text-blue-600",bgColor:"bg-blue-50"},{title:"Active Promotions",value:(null==t?void 0:t.activePromotions)||0,icon:d.Z,color:"bg-green-100 text-green-600",bgColor:"bg-green-50"},{title:"Expired Promotions",value:(null==t?void 0:t.expiredPromotions)||0,icon:J.Z,color:"bg-orange-100 text-orange-600",bgColor:"bg-orange-50"},{title:"Scheduled Promotions",value:(null==t?void 0:t.scheduledPromotions)||0,icon:z.Z,color:"bg-purple-100 text-purple-600",bgColor:"bg-purple-50"},{title:"Total Discount Value",value:r((null==t?void 0:t.totalDiscountValue)||0),icon:U.Z,color:"bg-red-100 text-red-600",bgColor:"bg-red-50",isValueNumeric:!1},{title:"Products with Promotions",value:(null==t?void 0:t.productsWithPromotions)||0,icon:H.Z,color:"bg-indigo-100 text-indigo-600",bgColor:"bg-indigo-50"},{title:"Vendors with Promotions",value:(null==t?void 0:t.vendorsWithPromotions)||0,icon:Q.Z,color:"bg-teal-100 text-teal-600",bgColor:"bg-teal-50"}];return(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7 gap-4",children:a.map((e,a)=>{let i=e.icon;return(0,s.jsxs)("div",{className:"".concat(e.bgColor," rounded-card shadow-soft border border-border-light p-6 transition-all duration-200 hover:shadow-medium"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-text-secondary mb-1 truncate",children:e.title}),(0,s.jsx)("p",{className:"text-2xl font-bold text-text-primary",children:!1===e.isValueNumeric?e.value:e.value.toLocaleString()}),"Active Promotions"===e.title&&t&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-text-tertiary mb-1",children:[(0,s.jsx)("span",{children:"Active Rate"}),(0,s.jsxs)("span",{children:[t.totalPromotions>0?Math.round(t.activePromotions/t.totalPromotions*100):0,"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,s.jsx)("div",{className:"bg-green-500 h-1.5 rounded-full transition-all duration-300",style:{width:t.totalPromotions>0?"".concat(t.activePromotions/t.totalPromotions*100,"%"):"0%"}})})]}),"Expired Promotions"===e.title&&t&&t.expiredPromotions>0&&(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsxs)("span",{className:"text-xs text-orange-600 font-medium",children:[t.totalPromotions>0?Math.round(t.expiredPromotions/t.totalPromotions*100):0,"% of total"]})})]}),(0,s.jsx)("div",{className:"h-12 w-12 ".concat(e.color," rounded-lg flex items-center justify-center flex-shrink-0 ml-4"),children:(0,s.jsx)(i,{className:"h-6 w-6"})})]}),"Total Discount Value"===e.title&&t&&t.activePromotions>0&&(0,s.jsx)("div",{className:"mt-3 pt-3 border-t border-red-200",children:(0,s.jsxs)("p",{className:"text-xs text-text-tertiary",children:["Avg per active promotion: ",r(t.totalDiscountValue/t.activePromotions)]})})]},a)})})}var ee=r(76737);function et(){let[e,t]=(0,a.useState)({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"}),[r,i]=(0,a.useState)(!1),[o,n]=(0,a.useState)(!1),[d,l]=(0,a.useState)(),{data:c,isLoading:m}=j(e),{data:u}=N(),x=(()=>{let e=(null==c?void 0:c.items)||[],t=(null==c?void 0:c.totalCount)||0,r=e.filter(e=>e.isActive).length,s=e.filter(e=>!e.isActive).length,a=new Date;return{total:t,active:r,inactive:s,expired:e.filter(e=>e.endDate&&new Date(e.endDate)<a).length,scheduled:e.filter(e=>e.startDate&&new Date(e.startDate)>a).length}})();return(0,s.jsx)(ee.Z,{permission:L.y3.VIEW_PROMOTIONS,children:(0,s.jsxs)("div",{className:"space-y-6 p-6 bg-surface-primary min-h-screen",children:[(0,s.jsx)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-text-primary tracking-tight",children:"Product Promotions Management"}),(0,s.jsx)("p",{className:"text-sm text-text-secondary mt-1",children:"Create and manage product promotions, discounts, and special offers"}),(0,s.jsxs)("div",{className:"flex items-center space-x-6 mt-4",children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-text-primary",children:x.total.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Total"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-success-600",children:x.active.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Active"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:x.inactive.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Inactive"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-orange-600",children:x.expired.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Expired"})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-blue-600",children:x.scheduled.toLocaleString()}),(0,s.jsx)("span",{className:"text-text-tertiary ml-1",children:"Scheduled"})]})]})]})}),(0,s.jsx)(X,{stats:u}),(0,s.jsx)(_,{filters:e,onFiltersChange:t}),(0,s.jsx)(R,{filters:e,onFiltersChange:t,onCreateClick:()=>{l(void 0),i(!0)},onEditClick:e=>{l(e),i(!0)},onDetailsClick:e=>{console.log("View details for:",e.id)},onBulkPromotionClick:()=>{n(!0)},isLoading:m}),(0,s.jsx)(W,{isOpen:r,onClose:()=>{i(!1),l(void 0)},promotion:d}),(0,s.jsx)(Y,{isOpen:o,onClose:()=>{n(!1)}})]})})}},76737:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(57437),a=r(2265),i=r(99376),o=r(19157);function n(e){let{children:t,permission:r,fallback:n=null,redirectTo:d="/unauthorized"}=e,[l,c]=(0,a.useState)(null),m=(0,i.useRouter)();return((0,a.useEffect)(()=>{(()=>{let e=o.$.hasPermission(r);c(e),!e&&d&&m.push(d)})()},[r,d,m]),null===l)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):l?(0,s.jsx)(s.Fragment,{children:t}):n?(0,s.jsx)(s.Fragment,{children:n}):(0,s.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-text-primary mb-4",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-text-secondary mb-6",children:"You don't have permission to access this page."}),(0,s.jsx)("button",{onClick:()=>m.back(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Go Back"})]})})}},88013:function(e,t,r){"use strict";r.d(t,{R:function(){return a}});var s=r(51034);class a{async get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.Nv)(()=>s.ZP.get("".concat(this.endpoint).concat(e)))}async post(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,s.Nv)(()=>s.ZP.post("".concat(this.endpoint).concat(e),t))}async put(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,s.Nv)(()=>s.ZP.put("".concat(this.endpoint).concat(e),t))}async patch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,s.Nv)(()=>s.ZP.patch("".concat(this.endpoint).concat(e),t))}async deleteRequest(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.Nv)(()=>s.ZP.delete("".concat(this.endpoint).concat(e)))}async getAll(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[r,s]=e;null!=s&&t.append(r,s.toString())});let r=t.toString()?"?".concat(t):"";return this.get(r)}async getById(e){return this.get("/".concat(e))}async create(e){return this.post("",e)}async update(e,t){return this.put("/".concat(e),t)}async delete(e){return this.deleteRequest("/".concat(e))}async bulkAction(e,t,r){return this.post("/bulk-action",{action:e,ids:t,data:r})}constructor(e){this.endpoint=e}}}},function(e){e.O(0,[3464,9763,1713,6977,2324,4297,3381,1021,7697,73,2971,2117,1744],function(){return e(e.s=38077)}),_N_E=e.O()}]);