(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9674],{80364:function(e,t,s){Promise.resolve().then(s.bind(s,94198))},99376:function(e,t,s){"use strict";var a=s(35475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}}),s.o(a,"useServerInsertedHTML")&&s.d(t,{useServerInsertedHTML:function(){return a.useServerInsertedHTML}})},94198:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return K}});var a=s(57437),r=s(2265),n=s(11713),l=s(29827),i=s(21770),c=s(88013);class o extends c.R{async getAllCustomers(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&""!==a&&t.append(s,a.toString())});let s=t.toString()?"?".concat(t):"";return this.get(s)}async getCustomerById(e){return this.get("/".concat(e))}async getCustomerOrders(e,t){let s=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,a]=e;null!=a&&""!==a&&s.append(t,a.toString())});let a="/".concat(e,"/orders").concat(s.toString()?"?".concat(s):"");return this.get(a)}async suspendCustomer(e,t){return this.put("/".concat(e,"/suspend"),t)}async activateCustomer(e,t){return this.put("/".concat(e,"/activate"),t||{})}async updateCustomerStatus(e,t){return this.put("/".concat(e,"/status"),t)}async deleteCustomer(e){return await this.deleteRequest("/".concat(e)),!0}async getCustomerStats(e,t){let s=new URLSearchParams;e&&s.append("dateFrom",e),t&&s.append("dateTo",t);let a="/stats".concat(s.toString()?"?".concat(s):"");return this.get(a)}async getCustomerActivities(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return this.get("/".concat(e,"/activities?limit=").concat(t))}async banCustomer(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this.updateCustomerStatus(e,{status:"Banned",reason:t,notifyCustomer:s})}async makeCustomerInactive(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this.updateCustomerStatus(e,{status:"Inactive",reason:t,notifyCustomer:s})}async bulkSuspend(e,t){return this.bulkAction("suspend",e,{reason:t})}async bulkActivate(e,t){return this.bulkAction("activate",e,{reason:t})}async bulkDelete(e,t){return this.bulkAction("delete",e,{reason:t})}constructor(){super("api/admin/customers")}}let d=new o,m={all:["customers"],lists:()=>[...m.all,"list"],list:e=>[...m.lists(),e],details:()=>[...m.all,"detail"],detail:e=>[...m.details(),e],orders:(e,t)=>[...m.detail(e),"orders",t],activities:(e,t)=>[...m.detail(e),"activities",t],stats:(e,t)=>[...m.all,"stats",e,t]};var x=s(41556),u=s(94565);let h=[{value:"",label:"All Statuses"},{value:"Active",label:"Active"},{value:"Suspended",label:"Suspended"},{value:"Inactive",label:"Inactive"},{value:"Banned",label:"Banned"}];function p(e){let{filters:t,onFiltersChange:s}=e,r=e=>{s({...t,search:e,pageNumber:1})},n=e=>{s({...t,status:e||void 0,pageNumber:1})},l=e=>{s({...t,dateFrom:e||void 0,pageNumber:1})},i=e=>{s({...t,dateTo:e||void 0,pageNumber:1})},c=e=>{s({...t,pageSize:parseInt(e),pageNumber:1})},o=Object.values(t).filter(Boolean).length-3;return(0,a.jsxs)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Customers"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by name, email, or phone...",value:t.search||"",onChange:e=>r(e.target.value),className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 placeholder-gray-500 transition-colors"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,a.jsx)("select",{value:t.status||"",onChange:e=>n(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors",children:h.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),(0,a.jsx)("input",{type:"date",value:t.dateFrom||"",onChange:e=>l(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),(0,a.jsx)("input",{type:"date",value:t.dateTo||"",onChange:e=>i(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors"})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[o," filter(s) applied"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Show:"}),(0,a.jsxs)("select",{value:t.pageSize||10,onChange:e=>c(e.target.value),className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 transition-colors",children:[(0,a.jsx)("option",{value:10,children:"10"}),(0,a.jsx)("option",{value:25,children:"25"}),(0,a.jsx)("option",{value:50,children:"50"}),(0,a.jsx)("option",{value:100,children:"100"})]})]}),(0,a.jsx)("button",{onClick:()=>{s({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"})},className:"text-sm text-primary-600 hover:text-primary-700 font-medium transition-colors",children:"Clear Filters"})]})]})]})}var g=s(90173),y=s(81801),b=s(42548),v=s(60007),j=s(59035),f=s(61601),N=s(40196),w=s(85707),C=s(47842),k=s(77165);let S={suspend:{title:"Suspend",description:"This will prevent the customer from placing new orders",confirmText:"Suspend",buttonColor:"bg-yellow-600 hover:bg-yellow-700"},activate:{title:"Activate",description:"This will allow the customer to place orders again",confirmText:"Activate",buttonColor:"bg-green-600 hover:bg-green-700"},delete:{title:"Delete",description:"This will soft delete the customer. They can be restored later",confirmText:"Delete",buttonColor:"bg-red-600 hover:bg-red-700"},ban:{title:"Ban",description:"This will permanently ban the customer from the platform",confirmText:"Ban",buttonColor:"bg-red-600 hover:bg-red-700"}};function A(e){let{isOpen:t,onClose:s,onConfirm:n,action:l,itemName:i,itemType:c,requireReason:o=!0}=e,[d,m]=(0,r.useState)(""),[x,u]=(0,r.useState)(!1),h=S[l],p=async()=>{if(!o||d.trim()){u(!0);try{await n(d.trim()||void 0)}finally{u(!1),m("")}}},g=()=>{m(""),s()};return(0,a.jsx)(N.u,{appear:!0,show:t,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:g,children:[(0,a.jsx)(N.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(N.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(w.Vq.Panel,{className:"w-full max-w-md bg-background-secondary rounded-lg shadow-xl p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(C.Z,{className:"h-6 w-6 text-yellow-500"})}),(0,a.jsxs)(w.Vq.Title,{className:"text-lg font-semibold text-gray-900",children:[h.title," ",c]})]}),(0,a.jsx)("button",{onClick:g,className:"text-gray-400 hover:text-gray-500 p-1 rounded transition-colors",children:(0,a.jsx)(k.Z,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Are you sure you want to ",l," ",(0,a.jsx)("strong",{children:i}),"?"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:h.description})]}),o&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason ","activate"===l?"(optional)":"(required)"]}),(0,a.jsx)("textarea",{value:d,onChange:e=>m(e.target.value),placeholder:"Enter reason for ".concat(l,"ing this ").concat(c,"..."),rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-background-tertiary text-gray-900 placeholder-gray-500 transition-colors"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:g,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-background-accent transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:p,disabled:x||o&&"activate"!==l&&!d.trim(),className:"px-4 py-2 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed ".concat(h.buttonColor),children:x?"Processing...":h.confirmText})]})]})})})})]})})}var R=s(89399),F=s(89453),T=s(56422),D=s(41077);function P(e){var t;let{customerId:s,isOpen:l,onClose:i}=e,{data:c,isLoading:o,error:x}=(0,n.a)({queryKey:m.detail(s),queryFn:()=>d.getCustomerById(s),staleTime:3e5,enabled:!!s,retry:2}),{data:u,isLoading:h}=(t={pageSize:5},(0,n.a)({queryKey:m.orders(s,t),queryFn:()=>d.getCustomerOrders(s,t),staleTime:3e5,enabled:!!s,retry:2}));return o?(0,a.jsx)(N.u,{appear:!0,show:l,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:i,children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(w.Vq.Panel,{className:"w-full max-w-4xl bg-background-secondary rounded-lg shadow-xl p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-6"}),(0,a.jsx)("div",{className:"space-y-4",children:[...Array(6)].map((e,t)=>(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-full"},t))})]})})})})]})}):x||!c?(0,a.jsx)(N.u,{appear:!0,show:l,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:i,children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(w.Vq.Panel,{className:"w-full max-w-md bg-background-secondary rounded-lg shadow-xl p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-red-600",children:"Failed to load customer details"}),(0,a.jsx)("button",{onClick:i,className:"mt-4 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})]})})})})]})}):(0,a.jsx)(N.u,{appear:!0,show:l,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:i,children:[(0,a.jsx)(N.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(N.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(w.Vq.Panel,{className:"w-full max-w-4xl bg-background-secondary rounded-lg shadow-xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-background-tertiary px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-full bg-primary-50 flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-lg font-medium text-primary-700",children:[c.firstName[0],c.lastName[0]]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.Vq.Title,{className:"text-lg font-semibold text-gray-900",children:c.fullName}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,a.jsx)("span",{className:(e=>{let t="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(e.toLowerCase()){case"active":return"".concat(t," bg-green-100 text-green-800");case"suspended":return"".concat(t," bg-yellow-100 text-yellow-800");case"inactive":default:return"".concat(t," bg-gray-100 text-gray-800");case"banned":return"".concat(t," bg-red-100 text-red-800")}})(c.status),children:c.status}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Customer since ",c.customerSince]})]})]})]}),(0,a.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg transition-colors",children:(0,a.jsx)(k.Z,{className:"h-6 w-6"})})]}),(0,a.jsx)("div",{className:"p-6 max-h-96 overflow-y-auto",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Contact Information"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(R.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:c.email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(F.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:c.phoneNumber})]}),c.address&&(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(T.Z,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,a.jsxs)("span",{className:"text-sm text-gray-900",children:[c.address,c.city&&", ".concat(c.city),c.state&&", ".concat(c.state),c.postalCode&&" ".concat(c.postalCode)]})]}),c.dateOfBirth&&(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(D.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:new Date(c.dateOfBirth).toLocaleDateString()})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-background-primary p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:c.totalOrders||0}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Total Orders"})]}),(0,a.jsxs)("div",{className:"bg-background-primary p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:["₦",(c.totalSpent||0).toLocaleString()]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Total Spent"})]})]})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Orders"}),h?(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-12 bg-gray-200 rounded animate-pulse"},t))}):(null==u?void 0:u.items)&&u.items.length>0?(0,a.jsx)("div",{className:"space-y-2",children:u.items.slice(0,5).map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.vendorName}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.orderDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["₦",e.totalAmount.toLocaleString()]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.status})]})]})},e.orderId))}):(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No orders found"})]})})]})}),(0,a.jsx)("div",{className:"bg-background-tertiary px-6 py-4 border-t border-gray-200 flex justify-end",children:(0,a.jsx)("button",{onClick:i,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})})]})})})})]})})}let q=e=>{let t="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(e.toLowerCase()){case"active":return"".concat(t," bg-green-100 text-green-800");case"suspended":return"".concat(t," bg-yellow-100 text-yellow-800");case"inactive":default:return"".concat(t," bg-gray-100 text-gray-800");case"banned":return"".concat(t," bg-red-100 text-red-800")}};function L(e){var t;let{filters:s,onFiltersChange:c}=e,[o,x]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),[p,N]=(0,r.useState)(!1),[w,C]=(0,r.useState)(null),{data:k,isLoading:S,error:R,refetch:F}=(0,n.a)({queryKey:m.list(s),queryFn:()=>d.getAllCustomers(s),staleTime:12e4,refetchInterval:3e5,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)});console.log("\uD83D\uDD0D Customer Table Data:",{customersData:k,isLoading:S,error:R,customersArray:null==k?void 0:k.items,customersCount:null==k?void 0:null===(t=k.items)||void 0===t?void 0:t.length});let T=function(){let e=(0,l.NL)();return(0,i.D)({mutationFn:e=>{let{customerId:t,request:s}=e;return d.suspendCustomer(t,s)},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.invalidateQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),D=function(){let e=(0,l.NL)();return(0,i.D)({mutationFn:e=>{let{customerId:t,request:s}=e;return d.activateCustomer(t,s)},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.invalidateQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),L=function(){let e=(0,l.NL)();return(0,i.D)({mutationFn:e=>{let{customerId:t}=e;return d.deleteCustomer(t)},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:m.lists()}),e.removeQueries({queryKey:m.detail(s.customerId)}),e.invalidateQueries({queryKey:m.stats()})}})}(),O=e=>{let t=s.sortBy===e&&"asc"===s.sortOrder?"desc":"asc";c({...s,sortBy:e,sortOrder:t,pageNumber:1})},Z=e=>{c({...s,pageNumber:e})},I=e=>{x(e),h(!0)},U=(e,t)=>{C({type:e,customer:t}),N(!0)},B=async e=>{if(!w)return;let{type:t,customer:s}=w;try{switch(t){case"suspend":await T.mutateAsync({customerId:s.id,request:{reason:e||"Administrative action",notifyCustomer:!0}});break;case"activate":await D.mutateAsync({customerId:s.id,request:{reason:e,notifyCustomer:!0}});break;case"delete":await L.mutateAsync({customerId:s.id,request:{reason:e||"Administrative deletion",permanentDelete:!1}})}}catch(e){console.error("Failed to ".concat(t," customer:"),e)}finally{C(null),N(!1)}};if(S)return(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded mb-4 w-40"}),(0,a.jsx)("div",{className:"space-y-3",children:[...Array(10)].map((e,t)=>(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))})]})});if(R)return(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-red-600",children:["Failed to load customers: ",R.message]}),(0,a.jsx)("button",{onClick:()=>F(),className:"px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-700 rounded-md text-sm transition-colors",children:"Retry"})]})})});let E=(null==k?void 0:k.items)||[],z=k?{pageNumber:k.pageNumber,pageSize:k.pageSize,totalCount:k.totalCount,totalPages:Math.ceil(k.totalCount/k.pageSize),page:k.pageNumber,limit:k.pageSize,total:k.totalCount}:null,M=e=>s.sortBy!==e?null:"asc"===s.sortOrder?(0,a.jsx)(g.Z,{className:"h-4 w-4"}):(0,a.jsx)(y.Z,{className:"h-4 w-4"});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-background-tertiary",children:(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Customers (",(null==z?void 0:z.totalCount)||0,")"]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-background-tertiary",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>O("firstName"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Customer"}),M("firstName")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>O("status"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Status"}),M("status")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>O("totalOrders"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Orders"}),M("totalOrders")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>O("totalSpent"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Total Spent"}),M("totalSpent")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-background-accent transition-colors",onClick:()=>O("createdAt"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"Joined"}),M("createdAt")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-background-secondary divide-y divide-gray-200",children:0===E.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center",children:(0,a.jsxs)("div",{className:"text-gray-500",children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"No customers found"}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Try adjusting your search filters"})]})})}):E.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-background-accent transition-colors cursor-pointer",onClick:()=>I(e),children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"h-10 w-10 flex-shrink-0",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-50 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-medium text-primary-700",children:e.fullName.split(" ").map(e=>e[0]).join("").slice(0,2)})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.fullName}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:q(e.status),children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.totalOrders}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["₦",e.totalSpent.toLocaleString()]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),I(e)},className:"text-primary-600 hover:text-primary-700 p-1 rounded transition-colors",title:"View Details",children:(0,a.jsx)(b.Z,{className:"h-4 w-4"})}),"Active"===e.status?(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),U("suspend",e)},className:"text-yellow-600 hover:text-yellow-700 p-1 rounded transition-colors",title:"Suspend Customer",children:(0,a.jsx)(v.Z,{className:"h-4 w-4"})}):(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),U("activate",e)},className:"text-green-600 hover:text-green-700 p-1 rounded transition-colors",title:"Activate Customer",children:(0,a.jsx)(j.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),U("delete",e)},className:"text-red-600 hover:text-red-700 p-1 rounded transition-colors",title:"Delete Customer",children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}),z&&z.totalPages>1&&(0,a.jsxs)("div",{className:"bg-background-tertiary px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,a.jsx)("button",{onClick:()=>Z(z.page-1),disabled:z.page<=1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-background-secondary hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>Z(z.page+1),disabled:z.page>=z.totalPages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-background-secondary hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]}),(0,a.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing"," ",(0,a.jsx)("span",{className:"font-medium",children:(z.page-1)*z.limit+1})," ","to"," ",(0,a.jsx)("span",{className:"font-medium",children:Math.min(z.page*z.limit,z.total)})," ","of"," ",(0,a.jsx)("span",{className:"font-medium",children:z.total})," ","results"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,a.jsx)("button",{onClick:()=>Z(z.page-1),disabled:z.page<=1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-background-secondary text-sm font-medium text-gray-500 hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),Array.from({length:Math.min(5,z.totalPages)},(e,t)=>{let s=Math.max(1,z.page-2)+t;return s>z.totalPages?null:(0,a.jsx)("button",{onClick:()=>Z(s),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium transition-colors ".concat(s===z.page?"z-10 bg-primary-500 border-primary-500 text-white":"bg-background-secondary border-gray-300 text-gray-500 hover:bg-background-accent"),children:s},s)}),(0,a.jsx)("button",{onClick:()=>Z(z.page+1),disabled:z.page>=z.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-background-secondary text-sm font-medium text-gray-500 hover:bg-background-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})})]})]})]}),o&&(0,a.jsx)(P,{customerId:o.id,isOpen:u,onClose:()=>{h(!1),x(null)}}),w&&(0,a.jsx)(A,{isOpen:p,onClose:()=>{N(!1),C(null)},onConfirm:B,action:w.type,itemName:w.customer.fullName,itemType:"customer",requireReason:"activate"!==w.type})]})}var O=s(63331),Z=s(338),I=s(68567);function U(e){let{isOpen:t,onClose:s,onUserSelect:n}=e,[l,i]=(0,r.useState)(""),[c,o]=(0,r.useState)([]),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(""),p=async e=>{if(!e.trim()||e.length<2){o([]);return}m(!0),h("");try{let t=await I.W.searchUsers(e);o(t)}catch(e){h(e instanceof Error?e.message:"Search failed"),o([])}finally{m(!1)}};(0,r.useEffect)(()=>{let e=setTimeout(()=>{p(l)},300);return()=>clearTimeout(e)},[l]);let g=e=>{n(e),s(),i(""),o([])},y=e=>{switch(e){case"Customer":return"bg-blue-100 text-blue-700";case"Vendor":return"bg-green-100 text-green-700";case"Rider":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-700"}};return t?(0,a.jsx)(N.u,{appear:!0,show:t,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:s,children:[(0,a.jsx)(N.x,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(N.x,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(w.EM,{className:"w-full max-w-2xl transform overflow-hidden rounded-card bg-surface-0 shadow-xl transition-all",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-border-light",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-text-primary flex items-center",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 mr-2"}),"Search Users"]}),(0,a.jsx)("button",{onClick:s,className:"p-2 hover:bg-surface-100 rounded-full transition-colors",children:(0,a.jsx)(k.Z,{className:"h-5 w-5 text-text-primary"})})]})}),(0,a.jsxs)("div",{className:"px-6 py-4",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(x.Z,{className:"h-5 w-5 text-text-tertiary"})}),(0,a.jsx)("input",{type:"text",value:l,onChange:e=>i(e.target.value),placeholder:"Search by name, email, or phone number...",className:"w-full pl-10 pr-4 py-3 border border-border-light rounded-button bg-surface-0 text-text-primary focus:ring-2 focus:ring-primary-500 focus:border-transparent",autoFocus:!0})]}),(0,a.jsxs)("div",{className:"max-h-96 overflow-y-auto",children:[d&&(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"}),(0,a.jsx)("span",{className:"ml-2 text-text-secondary",children:"Searching..."})]}),u&&(0,a.jsx)("div",{className:"p-4 bg-danger-50 border border-danger-200 rounded-card",children:(0,a.jsx)("p",{className:"text-sm text-danger-800",children:u})}),!d&&!u&&l&&l.length>=2&&0===c.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-text-tertiary",children:[(0,a.jsx)(Z.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,a.jsxs)("p",{children:['No users found matching "',l,'"']}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Try searching by name, email, or phone number"})]}),!d&&!u&&c.length>0&&(0,a.jsx)("div",{className:"space-y-2",children:c.map(e=>(0,a.jsx)("button",{onClick:()=>g(e),className:"w-full p-4 bg-surface-50 hover:bg-surface-100 rounded-card text-left transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,a.jsx)(Z.Z,{className:"h-5 w-5 text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-text-primary",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-text-secondary",children:e.email}),(0,a.jsx)("p",{className:"text-sm text-text-tertiary",children:e.phone})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(y(e.currentRole)),children:e.currentRole}),(0,a.jsx)("span",{className:"text-xs text-text-tertiary",children:e.status}),(e.hasActiveOrders||e.hasActiveDeliveries)&&(0,a.jsxs)("span",{className:"text-xs text-warning-600 font-medium",children:["Has active ",e.hasActiveOrders?"orders":"deliveries"]})]})]})},e.userId))}),(!l||l.length<2)&&(0,a.jsxs)("div",{className:"text-center py-8 text-text-tertiary",children:[(0,a.jsx)(x.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"Type at least 2 characters to search for users..."}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Search by name, email, or phone number"})]})]})]}),(0,a.jsx)("div",{className:"px-6 py-4 border-t border-border-light bg-surface-50",children:(0,a.jsx)("p",{className:"text-sm text-text-tertiary",children:"Select a user to switch their role. Users with active orders or deliveries cannot have their roles changed."})})]})})})})]})}):null}function B(e){let{user:t,isOpen:s,onClose:n,onSuccess:l}=e,[i,c]=(0,r.useState)("Customer"),[o,d]=(0,r.useState)(""),[m,x]=(0,r.useState)(!0),[u,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)(""),y=["Customer","Vendor","Rider"].filter(e=>e!==t.currentRole),b=async e=>{e.preventDefault(),h(!0),g("");try{let e={fromRole:t.currentRole,toRole:i,reason:o,notifyUser:m},s=await I.W.switchUserRole(t.userId,e);l(s),n()}catch(e){g(e instanceof Error?e.message:"An error occurred")}finally{h(!1)}},v=()=>window.confirm("Are you sure you want to switch ".concat(t.name,"'s role from ").concat(t.currentRole," to ").concat(i,"?\n\n")+"This will:\n"+"• Remove all ".concat(t.currentRole,"-specific data\n")+"• Create a new ".concat(i," profile\n")+"• Send them through ".concat(i," onboarding if needed\n")+"• Log this action for audit purposes\n\nThis action cannot be easily undone.");return s?(0,a.jsx)(N.u,{appear:!0,show:s,as:r.Fragment,children:(0,a.jsxs)(w.Vq,{as:"div",className:"relative z-50",onClose:n,children:[(0,a.jsx)(N.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsx)(N.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(w.Vq.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-card bg-surface-0 shadow-xl transition-all",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-border-light",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-text-primary flex items-center",children:[(0,a.jsx)(Z.Z,{className:"h-5 w-5 mr-2"}),"Switch User Role"]}),(0,a.jsx)("button",{onClick:n,className:"p-2 hover:bg-surface-100 rounded-full transition-colors",children:(0,a.jsx)(k.Z,{className:"h-5 w-5 text-text-primary"})})]})}),(0,a.jsxs)("div",{className:"px-6 py-4",children:[(0,a.jsxs)("div",{className:"mb-6 p-4 bg-surface-50 rounded-card",children:[(0,a.jsx)("h3",{className:"font-medium text-text-primary mb-2",children:"User Information"}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Name:"})," ",t.name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Email:"})," ",t.email]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Phone:"})," ",t.phone]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Current Role:"}),(0,a.jsx)("span",{className:"ml-1 px-2 py-1 bg-primary-100 text-primary-700 rounded text-xs",children:t.currentRole})]})]})]}),(t.hasActiveOrders||t.hasActiveDeliveries)&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-warning-50 border border-warning-200 rounded-card",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(C.Z,{className:"h-5 w-5 text-warning-600 mr-2 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"text-sm text-warning-800",children:[(0,a.jsx)("p",{className:"font-medium",children:"Warning"}),(0,a.jsxs)("p",{children:["This user has active ",t.hasActiveOrders?"orders":"deliveries",". Role switching will fail until these are completed."]})]})]})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),v()&&b(e)},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"toRole",className:"block text-sm font-medium text-text-secondary mb-2",children:"Switch to Role:"}),(0,a.jsx)("select",{id:"toRole",value:i,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-border-light rounded-button bg-surface-0 text-text-primary focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:y.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"reason",className:"block text-sm font-medium text-text-secondary mb-2",children:"Reason (optional):"}),(0,a.jsx)("textarea",{id:"reason",value:o,onChange:e=>d(e.target.value),placeholder:"Explain why this role change is needed...",maxLength:500,rows:3,className:"w-full px-3 py-2 border border-border-light rounded-button bg-surface-0 text-text-primary focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none"}),(0,a.jsxs)("p",{className:"text-xs text-text-tertiary mt-1",children:[o.length,"/500 characters"]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"notifyUser",checked:m,onChange:e=>x(e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-border-light rounded"}),(0,a.jsx)("label",{htmlFor:"notifyUser",className:"ml-2 text-sm text-text-primary",children:"Notify user via email"})]}),p&&(0,a.jsx)("div",{className:"p-3 bg-danger-50 border border-danger-200 rounded-card",children:(0,a.jsx)("p",{className:"text-sm text-danger-800",children:p})}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:n,disabled:u,className:"flex-1 px-4 py-2 text-text-primary bg-surface-100 hover:bg-surface-200 rounded-button transition-colors disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:u||t.hasActiveOrders||t.hasActiveDeliveries,className:"flex-1 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-button transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Switching...":"Switch to ".concat(i)})]})]})]})]})})})})]})}):null}function E(e){let{onSuccess:t,onError:s}=e,[n,l]=(0,r.useState)(!1),[i,c]=(0,r.useState)(!1),[o,d]=(0,r.useState)(null);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>l(!0),className:"inline-flex items-center px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-button transition-colors",children:[(0,a.jsx)(O.Z,{className:"h-5 w-5 mr-2"}),"Switch User Role"]}),(0,a.jsx)(U,{isOpen:n,onClose:()=>l(!1),onUserSelect:e=>{d(e),c(!0)}}),o&&(0,a.jsx)(B,{user:o,isOpen:i,onClose:()=>{c(!1),d(null)},onSuccess:e=>{d(null),t&&t(e)}})]})}var z=s(76737),M=s(8226),V=s(76529);function K(){var e,t;let[s,l]=(0,r.useState)({pageNumber:1,pageSize:10,sortBy:"createdAt",sortOrder:"desc"}),{data:i,isLoading:c}=(0,n.a)({queryKey:m.stats(void 0,void 0),queryFn:()=>d.getCustomerStats(e,t),staleTime:6e5,refetchInterval:9e5,retry:2}),[o,x]=(0,r.useState)(null);return(0,a.jsx)(z.Z,{permission:M.y3.VIEW_USERS,children:(0,a.jsxs)("div",{className:"space-y-6 p-6 bg-background-primary min-h-screen",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 tracking-tight",children:"Customer Management"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage customer accounts and monitor their activity"}),i&&!c&&(0,a.jsxs)("div",{className:"flex items-center space-x-6 mt-4",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:i.totalCustomers.toLocaleString()}),(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"Total"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-green-600",children:i.activeCustomers.toLocaleString()}),(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"Active"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-yellow-600",children:i.suspendedCustomers.toLocaleString()}),(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"Suspended"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-primary-600",children:i.newCustomersThisMonth.toLocaleString()}),(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"New this month"})]})]})]}),(0,a.jsx)(E,{onSuccess:e=>{x(e)},onError:e=>{console.error("Role switch failed:",e)}})]}),o&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Role Switch Successful"}),(0,a.jsxs)("div",{className:"mt-1 text-sm text-green-700",children:[(0,a.jsxs)("p",{children:["User ",o.userId," switched from ",o.fromRole," to ",o.toRole]}),(0,a.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Switched at ",new Date(o.switchedAt).toLocaleString()]})]})]}),(0,a.jsx)("div",{className:"ml-3 flex-shrink-0",children:(0,a.jsx)("button",{onClick:()=>x(null),className:"inline-flex text-green-400 hover:text-green-500 focus:outline-none",children:(0,a.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})}),i&&!c&&(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(0,V.x)(i.totalRevenue)})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-green-600 text-lg",children:"\uD83D\uDCB0"})})]})}),(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(0,V.x)(i.averageOrderValue)})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-primary-50 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-primary-600 text-lg",children:"\uD83D\uDCCA"})})]})}),(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[i.totalCustomers>0?Math.round(i.activeCustomers/i.totalCustomers*100):0,"%"]})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-blue-600 text-lg",children:"✅"})})]})}),(0,a.jsx)("div",{className:"bg-background-secondary rounded-lg shadow-sm border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Growth Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["+",i.totalCustomers>0?Math.round(i.newCustomersThisMonth/i.totalCustomers*100):0,"%"]})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-purple-600 text-lg",children:"\uD83D\uDCC8"})})]})})]}),(0,a.jsx)(p,{filters:s,onFiltersChange:l}),(0,a.jsx)(L,{filters:s,onFiltersChange:l})]})})}},76737:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(57437),r=s(2265),n=s(99376),l=s(19157);function i(e){let{children:t,permission:s,fallback:i=null,redirectTo:c="/unauthorized"}=e,[o,d]=(0,r.useState)(null),m=(0,n.useRouter)();return((0,r.useEffect)(()=>{(()=>{let e=l.$.hasPermission(s);d(e),!e&&c&&m.push(c)})()},[s,c,m]),null===o)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):o?(0,a.jsx)(a.Fragment,{children:t}):i?(0,a.jsx)(a.Fragment,{children:i}):(0,a.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-text-primary mb-4",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-text-secondary mb-6",children:"You don't have permission to access this page."}),(0,a.jsx)("button",{onClick:()=>m.back(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Go Back"})]})})}},88013:function(e,t,s){"use strict";s.d(t,{R:function(){return r}});var a=s(51034);class r{async get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,a.Nv)(()=>a.ZP.get("".concat(this.endpoint).concat(e)))}async post(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,a.Nv)(()=>a.ZP.post("".concat(this.endpoint).concat(e),t))}async put(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,a.Nv)(()=>a.ZP.put("".concat(this.endpoint).concat(e),t))}async patch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return(0,a.Nv)(()=>a.ZP.patch("".concat(this.endpoint).concat(e),t))}async deleteRequest(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,a.Nv)(()=>a.ZP.delete("".concat(this.endpoint).concat(e)))}async getAll(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&t.append(s,a.toString())});let s=t.toString()?"?".concat(t):"";return this.get(s)}async getById(e){return this.get("/".concat(e))}async create(e){return this.post("",e)}async update(e,t){return this.put("/".concat(e),t)}async delete(e){return this.deleteRequest("/".concat(e))}async bulkAction(e,t,s){return this.post("/bulk-action",{action:e,ids:t,data:s})}constructor(e){this.endpoint=e}}},68567:function(e,t,s){"use strict";s.d(t,{W:function(){return n}});var a=s(88013);class r extends a.R{async suspendUser(e){return this.post("/".concat(e,"/suspend"))}async activateUser(e){return this.post("/".concat(e,"/activate"))}async updateUserRole(e,t){return this.put("/".concat(e,"/role"),{roleId:t})}async getUserByEmail(e){try{return await this.get("/email/".concat(encodeURIComponent(e)))}catch(e){return null}}async bulkSuspendUsers(e){return this.bulkAction("suspend",e)}async bulkActivateUsers(e){return this.bulkAction("activate",e)}async getAllUsers(e){let t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&""!==a&&t.append(s,String(a))});let s=t.toString();return this.get(s?"?".concat(s):"")}async searchUsers(e){return(await this.getAllUsers({search:e,pageSize:20,sortBy:"firstName",sortOrder:"asc"})).items.map(e=>({userId:e.id,name:e.fullName,email:e.email,phone:e.phoneNumber,currentRole:e.role,status:e.status,hasActiveOrders:e.hasActiveOrders,hasActiveDeliveries:e.hasActiveDeliveries,walletId:e.walletId,walletBalance:e.walletBalance}))}async switchUserRole(e,t){return this.put("/".concat(e,"/switch-role"),t)}constructor(){super("/api/admin/users")}}let n=new r},76529:function(e,t,s){"use strict";s.d(t,{x:function(){return a}});let a=e=>"₦".concat(e.toLocaleString("en-NG",{minimumFractionDigits:2,maximumFractionDigits:2}))},63331:function(e,t,s){"use strict";var a=s(2265);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"}))});t.Z=r},338:function(e,t,s){"use strict";var a=s(2265);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))});t.Z=r}},function(e){e.O(0,[3464,9763,1713,9974,2017,73,2971,2117,1744],function(){return e(e.s=80364)}),_N_E=e.O()}]);